const Bu=Symbol(),Us=Object.getPrototypeOf,mn=new WeakMap,zu=t=>t&&(mn.has(t)?mn.get(t):Us(t)===Object.prototype||Us(t)===Array.prototype),qu=t=>zu(t)&&t[Bu]||null,Ls=(t,e=!0)=>{mn.set(t,e)},tn=t=>typeof t=="object"&&t!==null,Qt=new WeakMap,vi=new WeakSet,Ku=(t=Object.is,e=(l,f)=>new Proxy(l,f),r=l=>tn(l)&&!vi.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),i=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},n=new WeakMap,s=(l,f,y=i)=>{const _=n.get(l);if(_?.[0]===f)return _[1];const b=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return Ls(b,!0),n.set(l,[f,b]),Reflect.ownKeys(l).forEach(E=>{if(Object.getOwnPropertyDescriptor(b,E))return;const C=Reflect.get(l,E),F={value:C,enumerable:!0,configurable:!0};if(vi.has(C))Ls(C,!1);else if(C instanceof Promise)delete F.value,F.get=()=>y(C);else if(Qt.has(C)){const[z,D]=Qt.get(C);F.value=s(z,D(),y)}Object.defineProperty(b,E,F)}),b},o=new WeakMap,a=[1,1],h=l=>{if(!tn(l))throw new Error("object required");const f=o.get(l);if(f)return f;let y=a[0];const _=new Set,b=(N,R=++a[0])=>{y!==R&&(y=R,_.forEach(U=>U(N,R)))};let E=a[1];const C=(N=++a[1])=>(E!==N&&!_.size&&(E=N,z.forEach(([R])=>{const U=R[1](N);U>y&&(y=U)})),y),F=N=>(R,U)=>{const V=[...R];V[1]=[N,...V[1]],b(V,U)},z=new Map,D=(N,R)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&z.has(N))throw new Error("prop listener already exists");if(_.size){const U=R[3](F(N));z.set(N,[R,U])}else z.set(N,[R])},O=N=>{var R;const U=z.get(N);U&&(z.delete(N),(R=U[1])==null||R.call(U))},w=N=>(_.add(N),_.size===1&&z.forEach(([U,V],Y)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&V)throw new Error("remove already exists");const S=U[3](F(Y));z.set(Y,[U,S])}),()=>{_.delete(N),_.size===0&&z.forEach(([U,V],Y)=>{V&&(V(),z.set(Y,[U]))})}),v=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),c=e(v,{deleteProperty(N,R){const U=Reflect.get(N,R);O(R);const V=Reflect.deleteProperty(N,R);return V&&b(["delete",[R],U]),V},set(N,R,U,V){const Y=Reflect.has(N,R),S=Reflect.get(N,R,V);if(Y&&(t(S,U)||o.has(U)&&t(S,o.get(U))))return!0;O(R),tn(U)&&(U=qu(U)||U);let P=U;if(U instanceof Promise)U.then(k=>{U.status="fulfilled",U.value=k,b(["resolve",[R],k])}).catch(k=>{U.status="rejected",U.reason=k,b(["reject",[R],k])});else{!Qt.has(U)&&r(U)&&(P=h(U));const k=!vi.has(P)&&Qt.get(P);k&&D(R,k)}return Reflect.set(N,R,P,V),b(["set",[R],U,S]),!0}});o.set(l,c);const d=[v,C,s,w];return Qt.set(c,d),Reflect.ownKeys(l).forEach(N=>{const R=Object.getOwnPropertyDescriptor(l,N);"value"in R&&(c[N]=l[N],delete R.value,delete R.writable),Object.defineProperty(v,N,R)}),c})=>[h,Qt,vi,t,e,r,i,n,s,o,a],[Vu]=Ku();function ir(t={}){return Vu(t)}function vr(t,e,r){const i=Qt.get(t);(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!i&&console.warn("Please use proxy object");let n;const s=[],o=i[3];let a=!1;const l=o(f=>{if(s.push(f),r){e(s.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,a&&e(s.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Hu(t,e){const r=Qt.get(t);(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!r&&console.warn("Please use proxy object");const[i,n,s]=r;return s(i,n(),e)}var $s=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},zt=[],Tt=[],Wu=typeof Uint8Array<"u"?Uint8Array:Array,Qn=!1;function _a(){Qn=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)zt[e]=t[e],Tt[t.charCodeAt(e)]=e;Tt["-".charCodeAt(0)]=62,Tt["_".charCodeAt(0)]=63}function ku(t){Qn||_a();var e,r,i,n,s,o,a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s=t[a-2]==="="?2:t[a-1]==="="?1:0,o=new Wu(a*3/4-s),i=s>0?a-4:a;var h=0;for(e=0,r=0;e<i;e+=4,r+=3)n=Tt[t.charCodeAt(e)]<<18|Tt[t.charCodeAt(e+1)]<<12|Tt[t.charCodeAt(e+2)]<<6|Tt[t.charCodeAt(e+3)],o[h++]=n>>16&255,o[h++]=n>>8&255,o[h++]=n&255;return s===2?(n=Tt[t.charCodeAt(e)]<<2|Tt[t.charCodeAt(e+1)]>>4,o[h++]=n&255):s===1&&(n=Tt[t.charCodeAt(e)]<<10|Tt[t.charCodeAt(e+1)]<<4|Tt[t.charCodeAt(e+2)]>>2,o[h++]=n>>8&255,o[h++]=n&255),o}function Gu(t){return zt[t>>18&63]+zt[t>>12&63]+zt[t>>6&63]+zt[t&63]}function Yu(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16)+(t[s+1]<<8)+t[s+2],n.push(Gu(i));return n.join("")}function Ms(t){Qn||_a();for(var e,r=t.length,i=r%3,n="",s=[],o=16383,a=0,h=r-i;a<h;a+=o)s.push(Yu(t,a,a+o>h?h:a+o));return i===1?(e=t[r-1],n+=zt[e>>2],n+=zt[e<<4&63],n+="=="):i===2&&(e=(t[r-2]<<8)+t[r-1],n+=zt[e>>10],n+=zt[e>>4&63],n+=zt[e<<2&63],n+="="),s.push(n),s.join("")}function $i(t,e,r,i,n){var s,o,a=n*8-i-1,h=(1<<a)-1,l=h>>1,f=-7,y=r?n-1:0,_=r?-1:1,b=t[e+y];for(y+=_,s=b&(1<<-f)-1,b>>=-f,f+=a;f>0;s=s*256+t[e+y],y+=_,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=i;f>0;o=o*256+t[e+y],y+=_,f-=8);if(s===0)s=1-l;else{if(s===h)return o?NaN:(b?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-l}return(b?-1:1)*o*Math.pow(2,s-i)}function wa(t,e,r,i,n,s){var o,a,h,l=s*8-n-1,f=(1<<l)-1,y=f>>1,_=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=i?0:s-1,E=i?1:-1,C=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),o+y>=1?e+=_/h:e+=_*Math.pow(2,1-y),e*h>=2&&(o++,h/=2),o+y>=f?(a=0,o=f):o+y>=1?(a=(e*h-1)*Math.pow(2,n),o=o+y):(a=e*Math.pow(2,y-1)*Math.pow(2,n),o=0));n>=8;t[r+b]=a&255,b+=E,a/=256,n-=8);for(o=o<<n|a,l+=n;l>0;t[r+b]=o&255,b+=E,o/=256,l-=8);t[r+b-E]|=C*128}var Ju={}.toString,ba=Array.isArray||function(t){return Ju.call(t)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var Xu=50;j.TYPED_ARRAY_SUPPORT=$s.TYPED_ARRAY_SUPPORT!==void 0?$s.TYPED_ARRAY_SUPPORT:!0;Oi();function Oi(){return j.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Gt(t,e){if(Oi()<e)throw new RangeError("Invalid typed array length");return j.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=j.prototype):(t===null&&(t=new j(e)),t.length=e),t}function j(t,e,r){if(!j.TYPED_ARRAY_SUPPORT&&!(this instanceof j))return new j(t,e,r);if(typeof t=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return es(this,t)}return ma(this,t,e,r)}j.poolSize=8192;j._augment=function(t){return t.__proto__=j.prototype,t};function ma(t,e,r,i){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer?el(t,e,r,i):typeof e=="string"?Qu(t,e,r):tl(t,e)}j.from=function(t,e,r){return ma(null,t,e,r)};j.TYPED_ARRAY_SUPPORT&&(j.prototype.__proto__=Uint8Array.prototype,j.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&j[Symbol.species]);function va(t){if(typeof t!="number")throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Zu(t,e,r,i){return va(e),e<=0?Gt(t,e):r!==void 0?typeof i=="string"?Gt(t,e).fill(r,i):Gt(t,e).fill(r):Gt(t,e)}j.alloc=function(t,e,r){return Zu(null,t,e,r)};function es(t,e){if(va(e),t=Gt(t,e<0?0:ts(e)|0),!j.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}j.allocUnsafe=function(t){return es(null,t)};j.allocUnsafeSlow=function(t){return es(null,t)};function Qu(t,e,r){if((typeof r!="string"||r==="")&&(r="utf8"),!j.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=Ea(e,r)|0;t=Gt(t,i);var n=t.write(e,r);return n!==i&&(t=t.slice(0,n)),t}function vn(t,e){var r=e.length<0?0:ts(e.length)|0;t=Gt(t,r);for(var i=0;i<r;i+=1)t[i]=e[i]&255;return t}function el(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return r===void 0&&i===void 0?e=new Uint8Array(e):i===void 0?e=new Uint8Array(e,r):e=new Uint8Array(e,r,i),j.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=j.prototype):t=vn(t,e),t}function tl(t,e){if(qt(e)){var r=ts(e.length)|0;return t=Gt(t,r),t.length===0||e.copy(t,0,0,r),t}if(e){if(typeof ArrayBuffer<"u"&&e.buffer instanceof ArrayBuffer||"length"in e)return typeof e.length!="number"||ml(e.length)?Gt(t,0):vn(t,e);if(e.type==="Buffer"&&ba(e.data))return vn(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function ts(t){if(t>=Oi())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Oi().toString(16)+" bytes");return t|0}j.isBuffer=vl;function qt(t){return!!(t!=null&&t._isBuffer)}j.compare=function(e,r){if(!qt(e)||!qt(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var i=e.length,n=r.length,s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};j.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};j.concat=function(e,r){if(!ba(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return j.alloc(0);var i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;var n=j.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){var o=e[i];if(!qt(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,s),s+=o.length}return n};function Ea(t,e){if(qt(t))return t.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;typeof t!="string"&&(t=""+t);var r=t.length;if(r===0)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Ai(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Ta(t).length;default:if(i)return Ai(t).length;e=(""+e).toLowerCase(),i=!0}}j.byteLength=Ea;function rl(t,e,r){var i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return fl(this,e,r);case"utf8":case"utf-8":return xa(this,e,r);case"ascii":return ll(this,e,r);case"latin1":case"binary":return hl(this,e,r);case"base64":return cl(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dl(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}j.prototype._isBuffer=!0;function wr(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}j.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)wr(this,r,r+1);return this};j.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)wr(this,r,r+3),wr(this,r+1,r+2);return this};j.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)wr(this,r,r+7),wr(this,r+1,r+6),wr(this,r+2,r+5),wr(this,r+3,r+4);return this};j.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?xa(this,0,e):rl.apply(this,arguments)};j.prototype.equals=function(e){if(!qt(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:j.compare(this,e)===0};j.prototype.inspect=function(){var e="",r=Xu;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"};j.prototype.compare=function(e,r,i,n,s){if(!qt(e))throw new TypeError("Argument must be a Buffer");if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;for(var o=s-n,a=i-r,h=Math.min(o,a),l=this.slice(n,s),f=e.slice(r,i),y=0;y<h;++y)if(l[y]!==f[y]){o=l[y],a=f[y];break}return o<a?-1:a<o?1:0};function Da(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=j.from(e,i)),qt(e))return e.length===0?-1:js(t,e,r,i,n);if(typeof e=="number")return e=e&255,j.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):js(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function js(t,e,r,i,n){var s=1,o=t.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function h(b,E){return s===1?b[E]:b.readUInt16BE(E*s)}var l;if(n){var f=-1;for(l=r;l<o;l++)if(h(t,l)===h(e,f===-1?0:l-f)){if(f===-1&&(f=l),l-f+1===a)return f*s}else f!==-1&&(l-=l-f),f=-1}else for(r+a>o&&(r=o-a),l=r;l>=0;l--){for(var y=!0,_=0;_<a;_++)if(h(t,l+_)!==h(e,_)){y=!1;break}if(y)return l}return-1}j.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};j.prototype.indexOf=function(e,r,i){return Da(this,e,r,i,!0)};j.prototype.lastIndexOf=function(e,r,i){return Da(this,e,r,i,!1)};function il(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;var s=e.length;if(s%2!==0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(o*2,2),16);if(isNaN(a))return o;t[r+o]=a}return o}function nl(t,e,r,i){return Bi(Ai(e,t.length-r),t,r,i)}function Sa(t,e,r,i){return Bi(wl(e),t,r,i)}function sl(t,e,r,i){return Sa(t,e,r,i)}function ol(t,e,r,i){return Bi(Ta(e),t,r,i)}function al(t,e,r,i){return Bi(bl(e,t.length-r),t,r,i)}j.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r|0,isFinite(i)?(i=i|0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return il(this,e,r,i);case"utf8":case"utf-8":return nl(this,e,r,i);case"ascii":return Sa(this,e,r,i);case"latin1":case"binary":return sl(this,e,r,i);case"base64":return ol(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return al(this,e,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};j.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function cl(t,e,r){return e===0&&r===t.length?Ms(t):Ms(t.slice(e,r))}function xa(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var s=t[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=r){var h,l,f,y;switch(a){case 1:s<128&&(o=s);break;case 2:h=t[n+1],(h&192)===128&&(y=(s&31)<<6|h&63,y>127&&(o=y));break;case 3:h=t[n+1],l=t[n+2],(h&192)===128&&(l&192)===128&&(y=(s&15)<<12|(h&63)<<6|l&63,y>2047&&(y<55296||y>57343)&&(o=y));break;case 4:h=t[n+1],l=t[n+2],f=t[n+3],(h&192)===128&&(l&192)===128&&(f&192)===128&&(y=(s&15)<<18|(h&63)<<12|(l&63)<<6|f&63,y>65535&&y<1114112&&(o=y))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return ul(i)}var Bs=4096;function ul(t){var e=t.length;if(e<=Bs)return String.fromCharCode.apply(String,t);for(var r="",i=0;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=Bs));return r}function ll(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function hl(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function fl(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=_l(t[s]);return n}function dl(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}j.prototype.slice=function(e,r){var i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);var n;if(j.TYPED_ARRAY_SUPPORT)n=this.subarray(e,r),n.__proto__=j.prototype;else{var s=r-e;n=new j(s,void 0);for(var o=0;o<s;++o)n[o]=this[o+e]}return n};function it(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}j.prototype.readUIntLE=function(e,r,i){e=e|0,r=r|0,i||it(e,r,this.length);for(var n=this[e],s=1,o=0;++o<r&&(s*=256);)n+=this[e+o]*s;return n};j.prototype.readUIntBE=function(e,r,i){e=e|0,r=r|0,i||it(e,r,this.length);for(var n=this[e+--r],s=1;r>0&&(s*=256);)n+=this[e+--r]*s;return n};j.prototype.readUInt8=function(e,r){return r||it(e,1,this.length),this[e]};j.prototype.readUInt16LE=function(e,r){return r||it(e,2,this.length),this[e]|this[e+1]<<8};j.prototype.readUInt16BE=function(e,r){return r||it(e,2,this.length),this[e]<<8|this[e+1]};j.prototype.readUInt32LE=function(e,r){return r||it(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};j.prototype.readUInt32BE=function(e,r){return r||it(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};j.prototype.readIntLE=function(e,r,i){e=e|0,r=r|0,i||it(e,r,this.length);for(var n=this[e],s=1,o=0;++o<r&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};j.prototype.readIntBE=function(e,r,i){e=e|0,r=r|0,i||it(e,r,this.length);for(var n=r,s=1,o=this[e+--n];n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};j.prototype.readInt8=function(e,r){return r||it(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};j.prototype.readInt16LE=function(e,r){r||it(e,2,this.length);var i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};j.prototype.readInt16BE=function(e,r){r||it(e,2,this.length);var i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};j.prototype.readInt32LE=function(e,r){return r||it(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};j.prototype.readInt32BE=function(e,r){return r||it(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};j.prototype.readFloatLE=function(e,r){return r||it(e,4,this.length),$i(this,e,!0,23,4)};j.prototype.readFloatBE=function(e,r){return r||it(e,4,this.length),$i(this,e,!1,23,4)};j.prototype.readDoubleLE=function(e,r){return r||it(e,8,this.length),$i(this,e,!0,52,8)};j.prototype.readDoubleBE=function(e,r){return r||it(e,8,this.length),$i(this,e,!1,52,8)};function mt(t,e,r,i,n,s){if(!qt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}j.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r|0,i=i|0,!n){var s=Math.pow(2,8*i)-1;mt(this,e,r,i,s,0)}var o=1,a=0;for(this[r]=e&255;++a<i&&(o*=256);)this[r+a]=e/o&255;return r+i};j.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r|0,i=i|0,!n){var s=Math.pow(2,8*i)-1;mt(this,e,r,i,s,0)}var o=i-1,a=1;for(this[r+o]=e&255;--o>=0&&(a*=256);)this[r+o]=e/a&255;return r+i};j.prototype.writeUInt8=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,1,255,0),j.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=e&255,r+1};function Mi(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(t.length-r,2);n<s;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>(i?n:1-n)*8}j.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,2,65535,0),j.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8):Mi(this,e,r,!0),r+2};j.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,2,65535,0),j.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=e&255):Mi(this,e,r,!1),r+2};function ji(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(t.length-r,4);n<s;++n)t[r+n]=e>>>(i?n:3-n)*8&255}j.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,4,4294967295,0),j.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255):ji(this,e,r,!0),r+4};j.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,4,4294967295,0),j.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255):ji(this,e,r,!1),r+4};j.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r|0,!n){var s=Math.pow(2,8*i-1);mt(this,e,r,i,s-1,-s)}var o=0,a=1,h=0;for(this[r]=e&255;++o<i&&(a*=256);)e<0&&h===0&&this[r+o-1]!==0&&(h=1),this[r+o]=(e/a>>0)-h&255;return r+i};j.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r|0,!n){var s=Math.pow(2,8*i-1);mt(this,e,r,i,s-1,-s)}var o=i-1,a=1,h=0;for(this[r+o]=e&255;--o>=0&&(a*=256);)e<0&&h===0&&this[r+o+1]!==0&&(h=1),this[r+o]=(e/a>>0)-h&255;return r+i};j.prototype.writeInt8=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,1,127,-128),j.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=e&255,r+1};j.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,2,32767,-32768),j.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8):Mi(this,e,r,!0),r+2};j.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,2,32767,-32768),j.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=e&255):Mi(this,e,r,!1),r+2};j.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,4,2147483647,-2147483648),j.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):ji(this,e,r,!0),r+4};j.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r|0,i||mt(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),j.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255):ji(this,e,r,!1),r+4};function Ia(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Oa(t,e,r,i,n){return n||Ia(t,e,r,4),wa(t,e,r,i,23,4),r+4}j.prototype.writeFloatLE=function(e,r,i){return Oa(this,e,r,!0,i)};j.prototype.writeFloatBE=function(e,r,i){return Oa(this,e,r,!1,i)};function Aa(t,e,r,i,n){return n||Ia(t,e,r,8),wa(t,e,r,i,52,8),r+8}j.prototype.writeDoubleLE=function(e,r,i){return Aa(this,e,r,!0,i)};j.prototype.writeDoubleBE=function(e,r,i){return Aa(this,e,r,!1,i)};j.prototype.copy=function(e,r,i,n){if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);var s=n-i,o;if(this===e&&i<r&&r<n)for(o=s-1;o>=0;--o)e[o+r]=this[o+i];else if(s<1e3||!j.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+r]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+s),r);return s};j.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),e.length===1){var s=e.charCodeAt(0);s<256&&(e=s)}if(n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!j.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else typeof e=="number"&&(e=e&255);if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);var o;if(typeof e=="number")for(o=r;o<i;++o)this[o]=e;else{var a=qt(e)?e:Ai(new j(e,n).toString()),h=a.length;for(o=0;o<i-r;++o)this[o+r]=a[o%h]}return this};var pl=/[^+\/0-9A-Za-z-_]/g;function gl(t){if(t=yl(t).replace(pl,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function yl(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function _l(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ai(t,e){e=e||1/0;for(var r,i=t.length,n=null,s=[],o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function wl(t){for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function bl(t,e){for(var r,i,n,s=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function Ta(t){return ku(gl(t))}function Bi(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function ml(t){return t!==t}function vl(t){return t!=null&&(!!t._isBuffer||Ca(t)||El(t))}function Ca(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function El(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&Ca(t.slice(0,0))}const Qe=ir({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),Pa={state:Qe,subscribe(t){return vr(Qe,()=>t(Qe))},push(t,e){t!==Qe.view&&(Qe.view=t,e&&(Qe.data=e),Qe.history.push(t))},reset(t){Qe.view=t,Qe.history=[t]},replace(t){Qe.history.length>1&&(Qe.history[Qe.history.length-1]=t,Qe.view=t)},goBack(){if(Qe.history.length>1){Qe.history.pop();const[t]=Qe.history.slice(-1);Qe.view=t}},setData(t){Qe.data=t}},pt={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile(){return typeof window<"u"?Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return pt.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isIos(){const t=navigator.userAgent.toLowerCase();return pt.isMobile()&&(t.includes("iphone")||t.includes("ipad"))},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},isArray(t){return Array.isArray(t)&&t.length>0},formatNativeUrl(t,e,r){if(pt.isHttpUrl(t))return this.formatUniversalUrl(t,e,r);let i=t;i.includes("://")||(i=t.replaceAll("/","").replaceAll(":",""),i=`${i}://`),i.endsWith("/")||(i=`${i}/`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}wc?uri=${n}`},formatUniversalUrl(t,e,r){if(!pt.isHttpUrl(t))return this.formatNativeUrl(t,e,r);let i=t;i.endsWith("/")||(i=`${i}/`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}wc?uri=${n}`},async wait(t){return new Promise(e=>{setTimeout(e,t)})},openHref(t,e){window.open(t,e,"noreferrer noopener")},setWalletConnectDeepLink(t,e){try{localStorage.setItem(pt.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(t){try{const[e]=t.split("?");localStorage.setItem(pt.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:"Android"}))}catch{console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(pt.WALLETCONNECT_DEEPLINK_CHOICE)}catch{console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{typeof localStorage<"u"&&localStorage.setItem(pt.WCM_VERSION,"2.5.9")}catch{console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var t;const e=(t=Pa.state.data)==null?void 0:t.Wallet;if(!e)throw new Error('Missing "Wallet" view data');return e}},Dl=typeof location<"u"&&(location.hostname.includes("localhost")||location.protocol.includes("https")),ct=ir({enabled:Dl,userSessionId:"",events:[],connectedWalletId:void 0}),Sl={state:ct,subscribe(t){return vr(ct.events,()=>t(Hu(ct.events[ct.events.length-1])))},initialize(){ct.enabled&&typeof(crypto==null?void 0:crypto.randomUUID)<"u"&&(ct.userSessionId=crypto.randomUUID())},setConnectedWalletId(t){ct.connectedWalletId=t},click(t){if(ct.enabled){const e={type:"CLICK",name:t.name,userSessionId:ct.userSessionId,timestamp:Date.now(),data:t};ct.events.push(e)}},track(t){if(ct.enabled){const e={type:"TRACK",name:t.name,userSessionId:ct.userSessionId,timestamp:Date.now(),data:t};ct.events.push(e)}},view(t){if(ct.enabled){const e={type:"VIEW",name:t.name,userSessionId:ct.userSessionId,timestamp:Date.now(),data:t};ct.events.push(e)}}},Lt=ir({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),Ft={state:Lt,subscribe(t){return vr(Lt,()=>t(Lt))},setChains(t){Lt.chains=t},setWalletConnectUri(t){Lt.walletConnectUri=t},setIsCustomDesktop(t){Lt.isCustomDesktop=t},setIsCustomMobile(t){Lt.isCustomMobile=t},setIsDataLoaded(t){Lt.isDataLoaded=t},setIsUiLoaded(t){Lt.isUiLoaded=t},setIsAuth(t){Lt.isAuth=t}},Ei=ir({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),Rr={state:Ei,subscribe(t){return vr(Ei,()=>t(Ei))},setConfig(t){var e,r;Sl.initialize(),Ft.setChains(t.chains),Ft.setIsAuth(Boolean(t.enableAuthMode)),Ft.setIsCustomMobile(Boolean((e=t.mobileWallets)==null?void 0:e.length)),Ft.setIsCustomDesktop(Boolean((r=t.desktopWallets)==null?void 0:r.length)),pt.setModalVersionInStorage(),Object.assign(Ei,t)}},En="https://explorer-api.walletconnect.com";async function Di(t,e){const r=new URL(t,En);return r.searchParams.append("projectId",Rr.state.projectId),Object.entries(e).forEach(([i,n])=>{n&&r.searchParams.append(i,String(n))}),(await fetch(r)).json()}const lr={async getDesktopListings(t){return Di("/w3m/v1/getDesktopListings",t)},async getMobileListings(t){return Di("/w3m/v1/getMobileListings",t)},async getInjectedListings(t){return Di("/w3m/v1/getInjectedListings",t)},async getAllListings(t){return Di("/w3m/v1/getAllListings",t)},getWalletImageUrl(t){return`${En}/w3m/v1/getWalletImage/${t}?projectId=${Rr.state.projectId}`},getAssetImageUrl(t){return`${En}/w3m/v1/getAssetImage/${t}?projectId=${Rr.state.projectId}`}};var xl=Object.defineProperty,zs=Object.getOwnPropertySymbols,Il=Object.prototype.hasOwnProperty,Ol=Object.prototype.propertyIsEnumerable,qs=(t,e,r)=>e in t?xl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Al=(t,e)=>{for(var r in e||(e={}))Il.call(e,r)&&qs(t,r,e[r]);if(zs)for(var r of zs(e))Ol.call(e,r)&&qs(t,r,e[r]);return t};const Ks=pt.isMobile(),$t=ir({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),Cw={state:$t,async getRecomendedWallets(){const{explorerRecommendedWalletIds:t,explorerExcludedWalletIds:e}=Rr.state;if(t==="NONE"||e==="ALL"&&!t)return $t.recomendedWallets;if(pt.isArray(t)){const r={recommendedIds:t.join(",")},{listings:i}=await lr.getAllListings(r),n=Object.values(i);n.sort((s,o)=>{const a=t.indexOf(s.id),h=t.indexOf(o.id);return a-h}),$t.recomendedWallets=n}else{const{chains:r,isAuth:i}=Ft.state,n=r?.join(","),s=pt.isArray(e),o={page:1,sdks:i?"auth_v1":void 0,entries:pt.RECOMMENDED_WALLET_AMOUNT,chains:n,version:2,excludedIds:s?e.join(","):void 0},{listings:a}=Ks?await lr.getMobileListings(o):await lr.getDesktopListings(o);$t.recomendedWallets=Object.values(a)}return $t.recomendedWallets},async getWallets(t){const e=Al({},t),{explorerRecommendedWalletIds:r,explorerExcludedWalletIds:i}=Rr.state,{recomendedWallets:n}=$t;if(i==="ALL")return $t.wallets;n.length?e.excludedIds=n.map(y=>y.id).join(","):pt.isArray(r)&&(e.excludedIds=r.join(",")),pt.isArray(i)&&(e.excludedIds=[e.excludedIds,i].filter(Boolean).join(",")),Ft.state.isAuth&&(e.sdks="auth_v1");const{page:s,search:o}=t,{listings:a,total:h}=Ks?await lr.getMobileListings(e):await lr.getDesktopListings(e),l=Object.values(a),f=o?"search":"wallets";return $t[f]={listings:[...$t[f].listings,...l],total:h,page:s??1},{listings:l,total:h}},getWalletImageUrl(t){return lr.getWalletImageUrl(t)},getAssetImageUrl(t){return lr.getAssetImageUrl(t)},resetSearch(){$t.search={listings:[],total:0,page:1}}},Ir=ir({open:!1}),rn={state:Ir,subscribe(t){return vr(Ir,()=>t(Ir))},async open(t){return new Promise(e=>{const{isUiLoaded:r,isDataLoaded:i}=Ft.state;if(Ft.setWalletConnectUri(t?.uri),Ft.setChains(t?.chains),Pa.reset("ConnectWallet"),r&&i)Ir.open=!0,e();else{const n=setInterval(()=>{const s=Ft.state;s.isUiLoaded&&s.isDataLoaded&&(clearInterval(n),Ir.open=!0,e())},200)}})},close(){Ir.open=!1}};var Tl=Object.defineProperty,Vs=Object.getOwnPropertySymbols,Cl=Object.prototype.hasOwnProperty,Pl=Object.prototype.propertyIsEnumerable,Hs=(t,e,r)=>e in t?Tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rl=(t,e)=>{for(var r in e||(e={}))Cl.call(e,r)&&Hs(t,r,e[r]);if(Vs)for(var r of Vs(e))Pl.call(e,r)&&Hs(t,r,e[r]);return t};function Nl(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const Br=ir({themeMode:Nl()?"dark":"light"}),Ws={state:Br,subscribe(t){return vr(Br,()=>t(Br))},setThemeConfig(t){const{themeMode:e,themeVariables:r}=t;e&&(Br.themeMode=e),r&&(Br.themeVariables=Rl({},r))}},hr=ir({open:!1,message:"",variant:"success"}),Pw={state:hr,subscribe(t){return vr(hr,()=>t(hr))},openToast(t,e){hr.open=!0,hr.message=t,hr.variant=e},closeToast(){hr.open=!1}};typeof window<"u"&&(window.Buffer||(window.Buffer=j),window.global||(window.global=window),window.process||(window.process={env:{}}),window.global||(window.global=window));let Fl=class{constructor(e){this.openModal=rn.open,this.closeModal=rn.close,this.subscribeModal=rn.subscribe,this.setTheme=Ws.setThemeConfig,Ws.setThemeConfig(e),Rr.setConfig(e),this.initUi()}async initUi(){if(typeof window<"u"){await import("./index-8b482981.js");const e=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",e),Ft.setIsUiLoaded(!0)}}};var Ul;function tr(){}tr.prototype=Object.create(null);function ce(){ce.init.call(this)}ce.EventEmitter=ce;ce.usingDomains=!1;ce.prototype.domain=void 0;ce.prototype._events=void 0;ce.prototype._maxListeners=void 0;ce.defaultMaxListeners=10;ce.init=function(){this.domain=null,ce.usingDomains&&Ul.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new tr,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ce.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this};function Ra(t){return t._maxListeners===void 0?ce.defaultMaxListeners:t._maxListeners}ce.prototype.getMaxListeners=function(){return Ra(this)};function Ll(t,e,r){if(e)t.call(r);else for(var i=t.length,n=ai(t,i),s=0;s<i;++s)n[s].call(r)}function $l(t,e,r,i){if(e)t.call(r,i);else for(var n=t.length,s=ai(t,n),o=0;o<n;++o)s[o].call(r,i)}function Ml(t,e,r,i,n){if(e)t.call(r,i,n);else for(var s=t.length,o=ai(t,s),a=0;a<s;++a)o[a].call(r,i,n)}function jl(t,e,r,i,n,s){if(e)t.call(r,i,n,s);else for(var o=t.length,a=ai(t,o),h=0;h<o;++h)a[h].call(r,i,n,s)}function Bl(t,e,r,i){if(e)t.apply(r,i);else for(var n=t.length,s=ai(t,n),o=0;o<n;++o)s[o].apply(r,i)}ce.prototype.emit=function(e){var r,i,n,s,o,a,h,l=e==="error";if(a=this._events,a)l=l&&a.error==null;else if(!l)return!1;if(h=this.domain,l){if(r=arguments[1],h)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=h,r.domainThrown=!1,h.emit("error",r);else{if(r instanceof Error)throw r;var f=new Error('Uncaught, unspecified "error" event. ('+r+")");throw f.context=r,f}return!1}if(i=a[e],!i)return!1;var y=typeof i=="function";switch(n=arguments.length,n){case 1:Ll(i,y,this);break;case 2:$l(i,y,this,arguments[1]);break;case 3:Ml(i,y,this,arguments[1],arguments[2]);break;case 4:jl(i,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(n-1),o=1;o<n;o++)s[o-1]=arguments[o];Bl(i,y,this,s)}return!0};function Na(t,e,r,i){var n,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(s=t._events,s?(s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]):(s=t._events=new tr,t._eventsCount=0),!o)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),!o.warned&&(n=Ra(t),n&&n>0&&o.length>n)){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,zl(a)}return t}function zl(t){typeof console.warn=="function"?console.warn(t):console.log(t)}ce.prototype.addListener=function(e,r){return Na(this,e,r,!1)};ce.prototype.on=ce.prototype.addListener;ce.prototype.prependListener=function(e,r){return Na(this,e,r,!0)};function Fa(t,e,r){var i=!1;function n(){t.removeListener(e,n),i||(i=!0,r.apply(t,arguments))}return n.listener=r,n}ce.prototype.once=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,Fa(this,e,r)),this};ce.prototype.prependOnceListener=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Fa(this,e,r)),this};ce.prototype.removeListener=function(e,r){var i,n,s,o,a;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(n=this._events,!n)return this;if(i=n[e],!i)return this;if(i===r||i.listener&&i.listener===r)--this._eventsCount===0?this._events=new tr:(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length;o-- >0;)if(i[o]===r||i[o].listener&&i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;if(i.length===1){if(i[0]=void 0,--this._eventsCount===0)return this._events=new tr,this;delete n[e]}else ql(i,s);n.removeListener&&this.emit("removeListener",e,a||r)}return this};ce.prototype.off=function(t,e){return this.removeListener(t,e)};ce.prototype.removeAllListeners=function(e){var r,i;if(i=this._events,!i)return this;if(!i.removeListener)return arguments.length===0?(this._events=new tr,this._eventsCount=0):i[e]&&(--this._eventsCount===0?this._events=new tr:delete i[e]),this;if(arguments.length===0){for(var n=Object.keys(i),s=0,o;s<n.length;++s)o=n[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new tr,this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r)do this.removeListener(e,r[r.length-1]);while(r[0]);return this};ce.prototype.listeners=function(e){var r,i,n=this._events;return n?(r=n[e],r?typeof r=="function"?i=[r.listener||r]:i=Kl(r):i=[]):i=[],i};ce.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Ua.call(t,e)};ce.prototype.listenerCount=Ua;function Ua(t){var e=this._events;if(e){var r=e[t];if(typeof r=="function")return 1;if(r)return r.length}return 0}ce.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function ql(t,e){for(var r=e,i=r+1,n=t.length;i<n;r+=1,i+=1)t[r]=t[i];t.pop()}function ai(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}function Kl(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}var Vl=Object.freeze({__proto__:null,EventEmitter:ce,default:ce}),Dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function nr(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){if(this instanceof i){var n=[null];n.push.apply(n,arguments);var s=Function.bind.apply(e,n);return new s}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var zi={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Dn=function(t,e){return Dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Dn(t,e)};function Wl(t,e){Dn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Sn=function(){return Sn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sn.apply(this,arguments)};function kl(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Gl(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Yl(t,e){return function(r,i){e(r,i,t)}}function Jl(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Xl(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(f){try{l(i.next(f))}catch(y){o(y)}}function h(f){try{l(i.throw(f))}catch(y){o(y)}}function l(f){f.done?s(f.value):n(f.value).then(a,h)}l((i=i.apply(t,e||[])).next())})}function Zl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ql(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function eh(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function xn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function La(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function th(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(La(arguments[e]));return t}function rh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ti(t){return this instanceof ti?(this.v=t,this):new ti(t)}function ih(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(_){i[_]&&(n[_]=function(b){return new Promise(function(E,C){s.push([_,b,E,C])>1||a(_,b)})})}function a(_,b){try{h(i[_](b))}catch(E){y(s[0][3],E)}}function h(_){_.value instanceof ti?Promise.resolve(_.value.v).then(l,f):y(s[0][2],_)}function l(_){a("next",_)}function f(_){a("throw",_)}function y(_,b){_(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function nh(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ti(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function sh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof xn=="function"?xn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(l){s({value:l,done:a})},o)}}function oh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ah(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ch(t){return t&&t.__esModule?t:{default:t}}function uh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function lh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var hh=Object.freeze({__proto__:null,get __assign(){return Sn},__asyncDelegator:nh,__asyncGenerator:ih,__asyncValues:sh,__await:ti,__awaiter:Xl,__classPrivateFieldGet:uh,__classPrivateFieldSet:lh,__createBinding:Ql,__decorate:Gl,__exportStar:eh,__extends:Wl,__generator:Zl,__importDefault:ch,__importStar:ah,__makeTemplateObject:oh,__metadata:Jl,__param:Yl,__read:La,__rest:kl,__spread:th,__spreadArrays:rh,__values:xn}),$a=nr(hh),ci={};Object.defineProperty(ci,"__esModule",{value:!0});function fh(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}ci.safeJsonParse=fh;function dh(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}ci.safeJsonStringify=dh;var zr={exports:{}},ks;function ph(){return ks||(ks=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Dt<"u"&&Dt.localStorage?zr.exports=Dt.localStorage:typeof window<"u"&&window.localStorage?zr.exports=window.localStorage:zr.exports=new e}()),zr.exports}var nn={},qr={},Gs;function gh(){if(Gs)return qr;Gs=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.IKeyValueStorage=void 0;class t{}return qr.IKeyValueStorage=t,qr}var Kr={},Ys;function yh(){if(Ys)return Kr;Ys=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.parseEntry=void 0;const t=ci;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return Kr.parseEntry=e,Kr}var Js;function _h(){return Js||(Js=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=$a;e.__exportStar(gh(),t),e.__exportStar(yh(),t)}(nn)),nn}Object.defineProperty(zi,"__esModule",{value:!0});zi.KeyValueStorage=void 0;const Ar=$a,Xs=ci,wh=Ar.__importDefault(ph()),bh=_h();class Ma{constructor(){this.localStorage=wh.default}getKeys(){return Ar.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Ar.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(bh.parseEntry)})}getItem(e){return Ar.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Xs.safeJsonParse(r)})}setItem(e,r){return Ar.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Xs.safeJsonStringify(r))})}removeItem(e){return Ar.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}zi.KeyValueStorage=Ma;var mh=zi.default=Ma,Nr={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var In=function(t,e){return In=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},In(t,e)};function vh(t,e){In(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var On=function(){return On=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},On.apply(this,arguments)};function Eh(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Dh(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Sh(t,e){return function(r,i){e(r,i,t)}}function xh(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ih(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(f){try{l(i.next(f))}catch(y){o(y)}}function h(f){try{l(i.throw(f))}catch(y){o(y)}}function l(f){f.done?s(f.value):n(f.value).then(a,h)}l((i=i.apply(t,e||[])).next())})}function Oh(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ah(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Th(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function An(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ja(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Ch(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ja(arguments[e]));return t}function Ph(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ri(t){return this instanceof ri?(this.v=t,this):new ri(t)}function Rh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(_){i[_]&&(n[_]=function(b){return new Promise(function(E,C){s.push([_,b,E,C])>1||a(_,b)})})}function a(_,b){try{h(i[_](b))}catch(E){y(s[0][3],E)}}function h(_){_.value instanceof ri?Promise.resolve(_.value.v).then(l,f):y(s[0][2],_)}function l(_){a("next",_)}function f(_){a("throw",_)}function y(_,b){_(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Nh(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ri(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Fh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof An=="function"?An(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(l){s({value:l,done:a})},o)}}function Uh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Lh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function $h(t){return t&&t.__esModule?t:{default:t}}function Mh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function jh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Bh=Object.freeze({__proto__:null,get __assign(){return On},__asyncDelegator:Nh,__asyncGenerator:Rh,__asyncValues:Fh,__await:ri,__awaiter:Ih,__classPrivateFieldGet:Mh,__classPrivateFieldSet:jh,__createBinding:Ah,__decorate:Dh,__exportStar:Th,__extends:vh,__generator:Oh,__importDefault:$h,__importStar:Lh,__makeTemplateObject:Uh,__metadata:xh,__param:Sh,__read:ja,__rest:Eh,__spread:Ch,__spreadArrays:Ph,__values:An}),qi=nr(Bh),Vr={},zh=nr(Vl),Q={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Tn=function(t,e){return Tn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Tn(t,e)};function qh(t,e){Tn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Cn=function(){return Cn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Cn.apply(this,arguments)};function Kh(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Vh(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Hh(t,e){return function(r,i){e(r,i,t)}}function Wh(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function kh(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(f){try{l(i.next(f))}catch(y){o(y)}}function h(f){try{l(i.throw(f))}catch(y){o(y)}}function l(f){f.done?s(f.value):n(f.value).then(a,h)}l((i=i.apply(t,e||[])).next())})}function Gh(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Yh(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Jh(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Pn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ba(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Xh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ba(arguments[e]));return t}function Zh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ii(t){return this instanceof ii?(this.v=t,this):new ii(t)}function Qh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(_){i[_]&&(n[_]=function(b){return new Promise(function(E,C){s.push([_,b,E,C])>1||a(_,b)})})}function a(_,b){try{h(i[_](b))}catch(E){y(s[0][3],E)}}function h(_){_.value instanceof ii?Promise.resolve(_.value.v).then(l,f):y(s[0][2],_)}function l(_){a("next",_)}function f(_){a("throw",_)}function y(_,b){_(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ef(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ii(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function tf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Pn=="function"?Pn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(l){s({value:l,done:a})},o)}}function rf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function nf(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function sf(t){return t&&t.__esModule?t:{default:t}}function of(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function af(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var cf=Object.freeze({__proto__:null,get __assign(){return Cn},__asyncDelegator:ef,__asyncGenerator:Qh,__asyncValues:tf,__await:ii,__awaiter:kh,__classPrivateFieldGet:of,__classPrivateFieldSet:af,__createBinding:Yh,__decorate:Vh,__exportStar:Jh,__extends:qh,__generator:Gh,__importDefault:sf,__importStar:nf,__makeTemplateObject:rf,__metadata:Wh,__param:Hh,__read:Ba,__rest:Kh,__spread:Xh,__spreadArrays:Zh,__values:Pn}),Ki=nr(cf),sn={},Hr={},Zs;function uf(){if(Zs)return Hr;Zs=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Hr.delay=t,Hr}var fr={},on={},dr={},Qs;function lf(){return Qs||(Qs=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.ONE_THOUSAND=dr.ONE_HUNDRED=void 0,dr.ONE_HUNDRED=100,dr.ONE_THOUSAND=1e3),dr}var an={},eo;function hf(){return eo||(eo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(an)),an}var to;function za(){return to||(to=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ki;e.__exportStar(lf(),t),e.__exportStar(hf(),t)}(on)),on}var ro;function ff(){if(ro)return fr;ro=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.fromMiliseconds=fr.toMiliseconds=void 0;const t=za();function e(i){return i*t.ONE_THOUSAND}fr.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return fr.fromMiliseconds=r,fr}var io;function df(){return io||(io=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ki;e.__exportStar(uf(),t),e.__exportStar(ff(),t)}(sn)),sn}var Or={},no;function pf(){if(no)return Or;no=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return Or.Watch=t,Or.default=t,Or}var cn={},Wr={},so;function gf(){if(so)return Wr;so=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.IWatch=void 0;class t{}return Wr.IWatch=t,Wr}var oo;function yf(){return oo||(oo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Ki.__exportStar(gf(),t)}(cn)),cn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ki;e.__exportStar(df(),t),e.__exportStar(pf(),t),e.__exportStar(yf(),t),e.__exportStar(za(),t)})(Q);var un={},kr={};let Er=class{};var _f=Object.freeze({__proto__:null,IEvents:Er}),wf=nr(_f),ao;function bf(){if(ao)return kr;ao=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.IHeartBeat=void 0;const t=wf;class e extends t.IEvents{constructor(i){super()}}return kr.IHeartBeat=e,kr}var co;function qa(){return co||(co=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),qi.__exportStar(bf(),t)}(un)),un}var ln={},pr={},uo;function mf(){if(uo)return pr;uo=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.HEARTBEAT_EVENTS=pr.HEARTBEAT_INTERVAL=void 0;const t=Q;return pr.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,pr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},pr}var lo;function Ka(){return lo||(lo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),qi.__exportStar(mf(),t)}(ln)),ln}var ho;function vf(){if(ho)return Vr;ho=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.HeartBeat=void 0;const t=qi,e=zh,r=Q,i=qa(),n=Ka();class s extends i.IHeartBeat{constructor(a){super(a),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=a?.interval||n.HEARTBEAT_INTERVAL}static init(a){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(a);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(a,h){this.events.on(a,h)}once(a,h){this.events.once(a,h)}off(a,h){this.events.off(a,h)}removeListener(a,h){this.events.removeListener(a,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Vr.HeartBeat=s,Vr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=qi;e.__exportStar(vf(),t),e.__exportStar(qa(),t),e.__exportStar(Ka(),t)})(Nr);var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Rn=function(t,e){return Rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Rn(t,e)};function Ef(t,e){Rn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Nn=function(){return Nn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Nn.apply(this,arguments)};function Df(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Sf(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function xf(t,e){return function(r,i){e(r,i,t)}}function If(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Of(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(f){try{l(i.next(f))}catch(y){o(y)}}function h(f){try{l(i.throw(f))}catch(y){o(y)}}function l(f){f.done?s(f.value):n(f.value).then(a,h)}l((i=i.apply(t,e||[])).next())})}function Af(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Tf(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Cf(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Fn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Va(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Pf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Va(arguments[e]));return t}function Rf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ni(t){return this instanceof ni?(this.v=t,this):new ni(t)}function Nf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(_){i[_]&&(n[_]=function(b){return new Promise(function(E,C){s.push([_,b,E,C])>1||a(_,b)})})}function a(_,b){try{h(i[_](b))}catch(E){y(s[0][3],E)}}function h(_){_.value instanceof ni?Promise.resolve(_.value.v).then(l,f):y(s[0][2],_)}function l(_){a("next",_)}function f(_){a("throw",_)}function y(_,b){_(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Ff(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ni(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Uf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Fn=="function"?Fn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(l){s({value:l,done:a})},o)}}function Lf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function $f(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Mf(t){return t&&t.__esModule?t:{default:t}}function jf(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Bf(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var zf=Object.freeze({__proto__:null,get __assign(){return Nn},__asyncDelegator:Ff,__asyncGenerator:Nf,__asyncValues:Uf,__await:ni,__awaiter:Of,__classPrivateFieldGet:jf,__classPrivateFieldSet:Bf,__createBinding:Tf,__decorate:Sf,__exportStar:Cf,__extends:Ef,__generator:Af,__importDefault:Mf,__importStar:$f,__makeTemplateObject:Lf,__metadata:If,__param:xf,__read:Va,__rest:Df,__spread:Pf,__spreadArrays:Rf,__values:Fn}),qf=nr(zf),hn,fo;function Kf(){if(fo)return hn;fo=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}hn=e;function e(r,i,n){var s=n&&n.stringify||t,o=1;if(typeof r=="object"&&r!==null){var a=i.length+o;if(a===1)return r;var h=new Array(a);h[0]=s(r);for(var l=1;l<a;l++)h[l]=s(i[l]);return h.join(" ")}if(typeof r!="string")return r;var f=i.length;if(f===0)return r;for(var y="",_=1-o,b=-1,E=r&&r.length||0,C=0;C<E;){if(r.charCodeAt(C)===37&&C+1<E){switch(b=b>-1?b:0,r.charCodeAt(C+1)){case 100:case 102:if(_>=f||i[_]==null)break;b<C&&(y+=r.slice(b,C)),y+=Number(i[_]),b=C+2,C++;break;case 105:if(_>=f||i[_]==null)break;b<C&&(y+=r.slice(b,C)),y+=Math.floor(Number(i[_])),b=C+2,C++;break;case 79:case 111:case 106:if(_>=f||i[_]===void 0)break;b<C&&(y+=r.slice(b,C));var F=typeof i[_];if(F==="string"){y+="'"+i[_]+"'",b=C+2,C++;break}if(F==="function"){y+=i[_].name||"<anonymous>",b=C+2,C++;break}y+=s(i[_]),b=C+2,C++;break;case 115:if(_>=f)break;b<C&&(y+=r.slice(b,C)),y+=String(i[_]),b=C+2,C++;break;case 37:b<C&&(y+=r.slice(b,C)),y+="%",b=C+2,C++,_--;break}++_}++C}return b===-1?r:(b<E&&(y+=r.slice(b)),y)}return hn}var fn,po;function Vf(){if(po)return fn;po=1;const t=Kf();fn=n;const e=v().console||{},r={mapHttpRequest:E,mapHttpResponse:E,wrapRequestSerializer:C,wrapResponseSerializer:C,wrapErrorSerializer:C,req:E,res:E,err:_};function i(p,c){return Array.isArray(p)?p.filter(function(N){return N!=="!stdSerializers.err"}):p===!0?Object.keys(c):!1}function n(p){p=p||{},p.browser=p.browser||{};const c=p.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const d=p.browser.write||e;p.browser.write&&(p.browser.asObject=!0);const N=p.serializers||{},R=i(p.browser.serialize,N);let U=p.browser.serialize;Array.isArray(p.browser.serialize)&&p.browser.serialize.indexOf("!stdSerializers.err")>-1&&(U=!1);const V=["error","fatal","warn","info","debug","trace"];typeof d=="function"&&(d.error=d.fatal=d.warn=d.info=d.debug=d.trace=d),p.enabled===!1&&(p.level="silent");const Y=p.level||"info",S=Object.create(d);S.log||(S.log=F),Object.defineProperty(S,"levelVal",{get:k}),Object.defineProperty(S,"level",{get:q,set:$});const P={transmit:c,serialize:R,asObject:p.browser.asObject,levels:V,timestamp:b(p)};S.levels=n.levels,S.level=Y,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=F,S.serializers=N,S._serialize=R,S._stdErrSerialize=U,S.child=B,c&&(S._logEvent=y());function k(){return this.level==="silent"?1/0:this.levels.values[this.level]}function q(){return this._level}function $(L){if(L!=="silent"&&!this.levels.values[L])throw Error("unknown level "+L);this._level=L,s(P,S,"error","log"),s(P,S,"fatal","error"),s(P,S,"warn","error"),s(P,S,"info","log"),s(P,S,"debug","log"),s(P,S,"trace","log")}function B(L,K){if(!L)throw new Error("missing bindings for child Pino");K=K||{},R&&L.serializers&&(K.serializers=L.serializers);const re=K.serializers;if(R&&re){var H=Object.assign({},N,re),ee=p.browser.serialize===!0?Object.keys(H):R;delete L.serializers,h([L],ee,H,this._stdErrSerialize)}function X(te){this._childLevel=(te._childLevel|0)+1,this.error=l(te,L,"error"),this.fatal=l(te,L,"fatal"),this.warn=l(te,L,"warn"),this.info=l(te,L,"info"),this.debug=l(te,L,"debug"),this.trace=l(te,L,"trace"),H&&(this.serializers=H,this._serialize=ee),c&&(this._logEvent=y([].concat(te._logEvent.bindings,L)))}return X.prototype=this,new X(this)}return S}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:z,epochTime:D,unixTime:O,isoTime:w});function s(p,c,d,N){const R=Object.getPrototypeOf(c);c[d]=c.levelVal>c.levels.values[d]?F:R[d]?R[d]:e[d]||e[N]||F,o(p,c,d)}function o(p,c,d){!p.transmit&&c[d]===F||(c[d]=function(N){return function(){const U=p.timestamp(),V=new Array(arguments.length),Y=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var S=0;S<V.length;S++)V[S]=arguments[S];if(p.serialize&&!p.asObject&&h(V,this._serialize,this.serializers,this._stdErrSerialize),p.asObject?N.call(Y,a(this,d,V,U)):N.apply(Y,V),p.transmit){const P=p.transmit.level||c.level,k=n.levels.values[P],q=n.levels.values[d];if(q<k)return;f(this,{ts:U,methodLevel:d,methodValue:q,transmitLevel:P,transmitValue:n.levels.values[p.transmit.level||c.level],send:p.transmit.send,val:c.levelVal},V)}}}(c[d]))}function a(p,c,d,N){p._serialize&&h(d,p._serialize,p.serializers,p._stdErrSerialize);const R=d.slice();let U=R[0];const V={};N&&(V.time=N),V.level=n.levels.values[c];let Y=(p._childLevel|0)+1;if(Y<1&&(Y=1),U!==null&&typeof U=="object"){for(;Y--&&typeof R[0]=="object";)Object.assign(V,R.shift());U=R.length?t(R.shift(),R):void 0}else typeof U=="string"&&(U=t(R.shift(),R));return U!==void 0&&(V.msg=U),V}function h(p,c,d,N){for(const R in p)if(N&&p[R]instanceof Error)p[R]=n.stdSerializers.err(p[R]);else if(typeof p[R]=="object"&&!Array.isArray(p[R]))for(const U in p[R])c&&c.indexOf(U)>-1&&U in d&&(p[R][U]=d[U](p[R][U]))}function l(p,c,d){return function(){const N=new Array(1+arguments.length);N[0]=c;for(var R=1;R<N.length;R++)N[R]=arguments[R-1];return p[d].apply(this,N)}}function f(p,c,d){const N=c.send,R=c.ts,U=c.methodLevel,V=c.methodValue,Y=c.val,S=p._logEvent.bindings;h(d,p._serialize||Object.keys(p.serializers),p.serializers,p._stdErrSerialize===void 0?!0:p._stdErrSerialize),p._logEvent.ts=R,p._logEvent.messages=d.filter(function(P){return S.indexOf(P)===-1}),p._logEvent.level.label=U,p._logEvent.level.value=V,N(U,p._logEvent,Y),p._logEvent=y(S)}function y(p){return{ts:0,messages:[],bindings:p||[],level:{label:"",value:0}}}function _(p){const c={type:p.constructor.name,msg:p.message,stack:p.stack};for(const d in p)c[d]===void 0&&(c[d]=p[d]);return c}function b(p){return typeof p.timestamp=="function"?p.timestamp:p.timestamp===!1?z:D}function E(){return{}}function C(p){return p}function F(){}function z(){return!1}function D(){return Date.now()}function O(){return Math.round(Date.now()/1e3)}function w(){return new Date(Date.now()).toISOString()}function v(){function p(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return p(self)||p(window)||p(this)||{}}}return fn}var gr={},go;function Ha(){return go||(go=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.PINO_CUSTOM_CONTEXT_KEY=gr.PINO_LOGGER_DEFAULTS=void 0,gr.PINO_LOGGER_DEFAULTS={level:"info"},gr.PINO_CUSTOM_CONTEXT_KEY="custom_context"),gr}var ft={},yo;function Hf(){if(yo)return ft;yo=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.generateChildLogger=ft.formatChildLoggerContext=ft.getLoggerContext=ft.setBrowserLoggerContext=ft.getBrowserLoggerContext=ft.getDefaultLoggerOptions=void 0;const t=Ha();function e(a){return Object.assign(Object.assign({},a),{level:a?.level||t.PINO_LOGGER_DEFAULTS.level})}ft.getDefaultLoggerOptions=e;function r(a,h=t.PINO_CUSTOM_CONTEXT_KEY){return a[h]||""}ft.getBrowserLoggerContext=r;function i(a,h,l=t.PINO_CUSTOM_CONTEXT_KEY){return a[l]=h,a}ft.setBrowserLoggerContext=i;function n(a,h=t.PINO_CUSTOM_CONTEXT_KEY){let l="";return typeof a.bindings>"u"?l=r(a,h):l=a.bindings().context||"",l}ft.getLoggerContext=n;function s(a,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=n(a,l);return f.trim()?`${f}/${h}`:h}ft.formatChildLoggerContext=s;function o(a,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=s(a,h,l),y=a.child({context:f});return i(y,f,l)}return ft.generateChildLogger=o,ft}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=qf,r=e.__importDefault(Vf());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Ha(),t),e.__exportStar(Hf(),t)})(ve);class Wf extends Er{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class kf extends Er{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}let Gf=class{constructor(e,r){this.logger=e,this.core=r}};class Yf extends Er{constructor(e,r){super(),this.relayer=e,this.logger=r}}let Jf=class extends Er{constructor(e){super()}},Xf=class{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}},Zf=class extends Er{constructor(e,r){super(),this.relayer=e,this.logger=r}},Qf=class extends Er{constructor(e,r){super(),this.core=e,this.logger=r}};class ed{constructor(e,r){this.projectId=e,this.logger=r}}let td=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},rd=class{constructor(e){this.client=e}};const id=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),nd=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Wa(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return nd(t)}catch{return t}}function rs(t){return typeof t=="string"?t:id(t)||""}var is={},Fr={},Vi={},Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.BrowserRandomSource=void 0;const _o=65536;class sd{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=_o)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,_o)));return r}}Hi.BrowserRandomSource=sd;function od(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wi={},St={};Object.defineProperty(St,"__esModule",{value:!0});function ad(t){for(var e=0;e<t.length;e++)t[e]=0;return t}St.wipe=ad;var cd={},ud=Object.freeze({__proto__:null,default:cd}),ld=nr(ud);Object.defineProperty(Wi,"__esModule",{value:!0});Wi.NodeRandomSource=void 0;const hd=St;class fd{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof od<"u"){const e=ld;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,hd.wipe)(r),i}}Wi.NodeRandomSource=fd;Object.defineProperty(Vi,"__esModule",{value:!0});Vi.SystemRandomSource=void 0;const dd=Hi,pd=Wi;class gd{constructor(){if(this.isAvailable=!1,this.name="",this._source=new dd.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new pd.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Vi.SystemRandomSource=gd;var se={},ka={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(a,h){var l=a>>>16&65535,f=a&65535,y=h>>>16&65535,_=h&65535;return f*_+(l*_+f*y<<16>>>0)|0}t.mul=Math.imul||e;function r(a,h){return a+h|0}t.add=r;function i(a,h){return a-h|0}t.sub=i;function n(a,h){return a<<h|a>>>32-h}t.rotl=n;function s(a,h){return a<<32-h|a>>>h}t.rotr=s;function o(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(a){return t.isInteger(a)&&a>=-t.MAX_SAFE_INTEGER&&a<=t.MAX_SAFE_INTEGER}})(ka);Object.defineProperty(se,"__esModule",{value:!0});var Ga=ka;function yd(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}se.readInt16BE=yd;function _d(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}se.readUint16BE=_d;function wd(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}se.readInt16LE=wd;function bd(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}se.readUint16LE=bd;function Ya(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}se.writeUint16BE=Ya;se.writeInt16BE=Ya;function Ja(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}se.writeUint16LE=Ja;se.writeInt16LE=Ja;function Un(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}se.readInt32BE=Un;function Ln(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}se.readUint32BE=Ln;function $n(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}se.readInt32LE=$n;function Mn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}se.readUint32LE=Mn;function Ti(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}se.writeUint32BE=Ti;se.writeInt32BE=Ti;function Ci(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}se.writeUint32LE=Ci;se.writeInt32LE=Ci;function md(t,e){e===void 0&&(e=0);var r=Un(t,e),i=Un(t,e+4);return r*4294967296+i-(i>>31)*4294967296}se.readInt64BE=md;function vd(t,e){e===void 0&&(e=0);var r=Ln(t,e),i=Ln(t,e+4);return r*4294967296+i}se.readUint64BE=vd;function Ed(t,e){e===void 0&&(e=0);var r=$n(t,e),i=$n(t,e+4);return i*4294967296+r-(r>>31)*4294967296}se.readInt64LE=Ed;function Dd(t,e){e===void 0&&(e=0);var r=Mn(t,e),i=Mn(t,e+4);return i*4294967296+r}se.readUint64LE=Dd;function Xa(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ti(t/4294967296>>>0,e,r),Ti(t>>>0,e,r+4),e}se.writeUint64BE=Xa;se.writeInt64BE=Xa;function Za(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ci(t>>>0,e,r),Ci(t/4294967296>>>0,e,r+4),e}se.writeUint64LE=Za;se.writeInt64LE=Za;function Sd(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}se.readUintBE=Sd;function xd(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}se.readUintLE=xd;function Id(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ga.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}se.writeUintBE=Id;function Od(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ga.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}se.writeUintLE=Od;function Ad(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}se.readFloat32BE=Ad;function Td(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}se.readFloat32LE=Td;function Cd(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}se.readFloat64BE=Cd;function Pd(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}se.readFloat64LE=Pd;function Rd(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}se.writeFloat32BE=Rd;function Nd(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}se.writeFloat32LE=Nd;function Fd(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}se.writeFloat64BE=Fd;function Ud(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}se.writeFloat64LE=Ud;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Vi,r=se,i=St;t.defaultRandomSource=new e.SystemRandomSource;function n(l,f=t.defaultRandomSource){return f.randomBytes(l)}t.randomBytes=n;function s(l=t.defaultRandomSource){const f=n(4,l),y=(0,r.readUint32LE)(f);return(0,i.wipe)(f),y}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function a(l,f=o,y=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let _="";const b=f.length,E=256-256%b;for(;l>0;){const C=n(Math.ceil(l*256/E),y);for(let F=0;F<C.length&&l>0;F++){const z=C[F];z<E&&(_+=f.charAt(z%b),l--)}(0,i.wipe)(C)}return _}t.randomString=a;function h(l,f=o,y=t.defaultRandomSource){const _=Math.ceil(l/(Math.log(f.length)/Math.LN2));return a(_,f,y)}t.randomStringForEntropy=h})(Fr);var Qa={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=se,r=St;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},a.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},a.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,y=l/536870912|0,_=l<<3,b=l%128<112?128:256;this._buffer[f]=128;for(var E=f+1;E<b-8;E++)this._buffer[E]=0;e.writeUint32BE(y,this._buffer,b-8),e.writeUint32BE(_,this._buffer,b-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,b),this._finished=!0}for(var E=0;E<this.digestLength/8;E++)e.writeUint32BE(this._stateHi[E],h,E*8),e.writeUint32BE(this._stateLo[E],h,E*8+4);return this},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},a}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(a,h,l,f,y,_,b){for(var E=l[0],C=l[1],F=l[2],z=l[3],D=l[4],O=l[5],w=l[6],v=l[7],p=f[0],c=f[1],d=f[2],N=f[3],R=f[4],U=f[5],V=f[6],Y=f[7],S,P,k,q,$,B,L,K;b>=128;){for(var re=0;re<16;re++){var H=8*re+_;a[re]=e.readUint32BE(y,H),h[re]=e.readUint32BE(y,H+4)}for(var re=0;re<80;re++){var ee=E,X=C,te=F,T=z,A=D,x=O,u=w,m=v,W=p,J=c,de=d,be=N,ge=R,De=U,$e=V,Re=Y;if(S=v,P=Y,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=(D>>>14|R<<32-14)^(D>>>18|R<<32-18)^(R>>>41-32|D<<32-(41-32)),P=(R>>>14|D<<32-14)^(R>>>18|D<<32-18)^(D>>>41-32|R<<32-(41-32)),$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,S=D&O^~D&w,P=R&U^~R&V,$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,S=n[re*2],P=n[re*2+1],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,S=a[re%16],P=h[re%16],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,k=L&65535|K<<16,q=$&65535|B<<16,S=k,P=q,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=(E>>>28|p<<32-28)^(p>>>34-32|E<<32-(34-32))^(p>>>39-32|E<<32-(39-32)),P=(p>>>28|E<<32-28)^(E>>>34-32|p<<32-(34-32))^(E>>>39-32|p<<32-(39-32)),$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,S=E&C^E&F^C&F,P=p&c^p&d^c&d,$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,m=L&65535|K<<16,Re=$&65535|B<<16,S=T,P=be,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=k,P=q,$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,T=L&65535|K<<16,be=$&65535|B<<16,C=ee,F=X,z=te,D=T,O=A,w=x,v=u,E=m,c=W,d=J,N=de,R=be,U=ge,V=De,Y=$e,p=Re,re%16===15)for(var H=0;H<16;H++)S=a[H],P=h[H],$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=a[(H+9)%16],P=h[(H+9)%16],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,k=a[(H+1)%16],q=h[(H+1)%16],S=(k>>>1|q<<32-1)^(k>>>8|q<<32-8)^k>>>7,P=(q>>>1|k<<32-1)^(q>>>8|k<<32-8)^(q>>>7|k<<32-7),$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,k=a[(H+14)%16],q=h[(H+14)%16],S=(k>>>19|q<<32-19)^(q>>>61-32|k<<32-(61-32))^k>>>6,P=(q>>>19|k<<32-19)^(k>>>61-32|q<<32-(61-32))^(q>>>6|k<<32-6),$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,a[H]=L&65535|K<<16,h[H]=$&65535|B<<16}S=E,P=p,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[0],P=f[0],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[0]=E=L&65535|K<<16,f[0]=p=$&65535|B<<16,S=C,P=c,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[1],P=f[1],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[1]=C=L&65535|K<<16,f[1]=c=$&65535|B<<16,S=F,P=d,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[2],P=f[2],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[2]=F=L&65535|K<<16,f[2]=d=$&65535|B<<16,S=z,P=N,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[3],P=f[3],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[3]=z=L&65535|K<<16,f[3]=N=$&65535|B<<16,S=D,P=R,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[4],P=f[4],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[4]=D=L&65535|K<<16,f[4]=R=$&65535|B<<16,S=O,P=U,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[5],P=f[5],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[5]=O=L&65535|K<<16,f[5]=U=$&65535|B<<16,S=w,P=V,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[6],P=f[6],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[6]=w=L&65535|K<<16,f[6]=V=$&65535|B<<16,S=v,P=Y,$=P&65535,B=P>>>16,L=S&65535,K=S>>>16,S=l[7],P=f[7],$+=P&65535,B+=P>>>16,L+=S&65535,K+=S>>>16,B+=$>>>16,L+=B>>>16,K+=L>>>16,l[7]=v=L&65535|K<<16,f[7]=Y=$&65535|B<<16,_+=128,b-=128}return _}function o(a){var h=new i;h.update(a);var l=h.digest();return h.clean(),l}t.hash=o})(Qa);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=Fr,r=Qa,i=St;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(T){const A=new Float64Array(16);if(T)for(let x=0;x<T.length;x++)A[x]=T[x];return A}const s=new Uint8Array(32);s[0]=9;const o=n(),a=n([1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(T,A){for(let x=0;x<16;x++)T[x]=A[x]|0}function E(T){let A=1;for(let x=0;x<16;x++){let u=T[x]+A+65535;A=Math.floor(u/65536),T[x]=u-A*65536}T[0]+=A-1+37*(A-1)}function C(T,A,x){const u=~(x-1);for(let m=0;m<16;m++){const W=u&(T[m]^A[m]);T[m]^=W,A[m]^=W}}function F(T,A){const x=n(),u=n();for(let m=0;m<16;m++)u[m]=A[m];E(u),E(u),E(u);for(let m=0;m<2;m++){x[0]=u[0]-65517;for(let J=1;J<15;J++)x[J]=u[J]-65535-(x[J-1]>>16&1),x[J-1]&=65535;x[15]=u[15]-32767-(x[14]>>16&1);const W=x[15]>>16&1;x[14]&=65535,C(u,x,1-W)}for(let m=0;m<16;m++)T[2*m]=u[m]&255,T[2*m+1]=u[m]>>8}function z(T,A){let x=0;for(let u=0;u<32;u++)x|=T[u]^A[u];return(1&x-1>>>8)-1}function D(T,A){const x=new Uint8Array(32),u=new Uint8Array(32);return F(x,T),F(u,A),z(x,u)}function O(T){const A=new Uint8Array(32);return F(A,T),A[0]&1}function w(T,A){for(let x=0;x<16;x++)T[x]=A[2*x]+(A[2*x+1]<<8);T[15]&=32767}function v(T,A,x){for(let u=0;u<16;u++)T[u]=A[u]+x[u]}function p(T,A,x){for(let u=0;u<16;u++)T[u]=A[u]-x[u]}function c(T,A,x){let u,m,W=0,J=0,de=0,be=0,ge=0,De=0,$e=0,Re=0,we=0,ye=0,pe=0,he=0,le=0,ue=0,ae=0,ie=0,fe=0,_e=0,ne=0,me=0,Ee=0,xe=0,Ie=0,Se=0,Ct=0,Ut=0,Yt=0,vt=0,or=0,$r=0,pi=0,Me=x[0],Ne=x[1],je=x[2],Be=x[3],ze=x[4],Fe=x[5],He=x[6],We=x[7],ke=x[8],Ge=x[9],Ye=x[10],Ve=x[11],qe=x[12],Te=x[13],Je=x[14],Xe=x[15];u=A[0],W+=u*Me,J+=u*Ne,de+=u*je,be+=u*Be,ge+=u*ze,De+=u*Fe,$e+=u*He,Re+=u*We,we+=u*ke,ye+=u*Ge,pe+=u*Ye,he+=u*Ve,le+=u*qe,ue+=u*Te,ae+=u*Je,ie+=u*Xe,u=A[1],J+=u*Me,de+=u*Ne,be+=u*je,ge+=u*Be,De+=u*ze,$e+=u*Fe,Re+=u*He,we+=u*We,ye+=u*ke,pe+=u*Ge,he+=u*Ye,le+=u*Ve,ue+=u*qe,ae+=u*Te,ie+=u*Je,fe+=u*Xe,u=A[2],de+=u*Me,be+=u*Ne,ge+=u*je,De+=u*Be,$e+=u*ze,Re+=u*Fe,we+=u*He,ye+=u*We,pe+=u*ke,he+=u*Ge,le+=u*Ye,ue+=u*Ve,ae+=u*qe,ie+=u*Te,fe+=u*Je,_e+=u*Xe,u=A[3],be+=u*Me,ge+=u*Ne,De+=u*je,$e+=u*Be,Re+=u*ze,we+=u*Fe,ye+=u*He,pe+=u*We,he+=u*ke,le+=u*Ge,ue+=u*Ye,ae+=u*Ve,ie+=u*qe,fe+=u*Te,_e+=u*Je,ne+=u*Xe,u=A[4],ge+=u*Me,De+=u*Ne,$e+=u*je,Re+=u*Be,we+=u*ze,ye+=u*Fe,pe+=u*He,he+=u*We,le+=u*ke,ue+=u*Ge,ae+=u*Ye,ie+=u*Ve,fe+=u*qe,_e+=u*Te,ne+=u*Je,me+=u*Xe,u=A[5],De+=u*Me,$e+=u*Ne,Re+=u*je,we+=u*Be,ye+=u*ze,pe+=u*Fe,he+=u*He,le+=u*We,ue+=u*ke,ae+=u*Ge,ie+=u*Ye,fe+=u*Ve,_e+=u*qe,ne+=u*Te,me+=u*Je,Ee+=u*Xe,u=A[6],$e+=u*Me,Re+=u*Ne,we+=u*je,ye+=u*Be,pe+=u*ze,he+=u*Fe,le+=u*He,ue+=u*We,ae+=u*ke,ie+=u*Ge,fe+=u*Ye,_e+=u*Ve,ne+=u*qe,me+=u*Te,Ee+=u*Je,xe+=u*Xe,u=A[7],Re+=u*Me,we+=u*Ne,ye+=u*je,pe+=u*Be,he+=u*ze,le+=u*Fe,ue+=u*He,ae+=u*We,ie+=u*ke,fe+=u*Ge,_e+=u*Ye,ne+=u*Ve,me+=u*qe,Ee+=u*Te,xe+=u*Je,Ie+=u*Xe,u=A[8],we+=u*Me,ye+=u*Ne,pe+=u*je,he+=u*Be,le+=u*ze,ue+=u*Fe,ae+=u*He,ie+=u*We,fe+=u*ke,_e+=u*Ge,ne+=u*Ye,me+=u*Ve,Ee+=u*qe,xe+=u*Te,Ie+=u*Je,Se+=u*Xe,u=A[9],ye+=u*Me,pe+=u*Ne,he+=u*je,le+=u*Be,ue+=u*ze,ae+=u*Fe,ie+=u*He,fe+=u*We,_e+=u*ke,ne+=u*Ge,me+=u*Ye,Ee+=u*Ve,xe+=u*qe,Ie+=u*Te,Se+=u*Je,Ct+=u*Xe,u=A[10],pe+=u*Me,he+=u*Ne,le+=u*je,ue+=u*Be,ae+=u*ze,ie+=u*Fe,fe+=u*He,_e+=u*We,ne+=u*ke,me+=u*Ge,Ee+=u*Ye,xe+=u*Ve,Ie+=u*qe,Se+=u*Te,Ct+=u*Je,Ut+=u*Xe,u=A[11],he+=u*Me,le+=u*Ne,ue+=u*je,ae+=u*Be,ie+=u*ze,fe+=u*Fe,_e+=u*He,ne+=u*We,me+=u*ke,Ee+=u*Ge,xe+=u*Ye,Ie+=u*Ve,Se+=u*qe,Ct+=u*Te,Ut+=u*Je,Yt+=u*Xe,u=A[12],le+=u*Me,ue+=u*Ne,ae+=u*je,ie+=u*Be,fe+=u*ze,_e+=u*Fe,ne+=u*He,me+=u*We,Ee+=u*ke,xe+=u*Ge,Ie+=u*Ye,Se+=u*Ve,Ct+=u*qe,Ut+=u*Te,Yt+=u*Je,vt+=u*Xe,u=A[13],ue+=u*Me,ae+=u*Ne,ie+=u*je,fe+=u*Be,_e+=u*ze,ne+=u*Fe,me+=u*He,Ee+=u*We,xe+=u*ke,Ie+=u*Ge,Se+=u*Ye,Ct+=u*Ve,Ut+=u*qe,Yt+=u*Te,vt+=u*Je,or+=u*Xe,u=A[14],ae+=u*Me,ie+=u*Ne,fe+=u*je,_e+=u*Be,ne+=u*ze,me+=u*Fe,Ee+=u*He,xe+=u*We,Ie+=u*ke,Se+=u*Ge,Ct+=u*Ye,Ut+=u*Ve,Yt+=u*qe,vt+=u*Te,or+=u*Je,$r+=u*Xe,u=A[15],ie+=u*Me,fe+=u*Ne,_e+=u*je,ne+=u*Be,me+=u*ze,Ee+=u*Fe,xe+=u*He,Ie+=u*We,Se+=u*ke,Ct+=u*Ge,Ut+=u*Ye,Yt+=u*Ve,vt+=u*qe,or+=u*Te,$r+=u*Je,pi+=u*Xe,W+=38*fe,J+=38*_e,de+=38*ne,be+=38*me,ge+=38*Ee,De+=38*xe,$e+=38*Ie,Re+=38*Se,we+=38*Ct,ye+=38*Ut,pe+=38*Yt,he+=38*vt,le+=38*or,ue+=38*$r,ae+=38*pi,m=1,u=W+m+65535,m=Math.floor(u/65536),W=u-m*65536,u=J+m+65535,m=Math.floor(u/65536),J=u-m*65536,u=de+m+65535,m=Math.floor(u/65536),de=u-m*65536,u=be+m+65535,m=Math.floor(u/65536),be=u-m*65536,u=ge+m+65535,m=Math.floor(u/65536),ge=u-m*65536,u=De+m+65535,m=Math.floor(u/65536),De=u-m*65536,u=$e+m+65535,m=Math.floor(u/65536),$e=u-m*65536,u=Re+m+65535,m=Math.floor(u/65536),Re=u-m*65536,u=we+m+65535,m=Math.floor(u/65536),we=u-m*65536,u=ye+m+65535,m=Math.floor(u/65536),ye=u-m*65536,u=pe+m+65535,m=Math.floor(u/65536),pe=u-m*65536,u=he+m+65535,m=Math.floor(u/65536),he=u-m*65536,u=le+m+65535,m=Math.floor(u/65536),le=u-m*65536,u=ue+m+65535,m=Math.floor(u/65536),ue=u-m*65536,u=ae+m+65535,m=Math.floor(u/65536),ae=u-m*65536,u=ie+m+65535,m=Math.floor(u/65536),ie=u-m*65536,W+=m-1+37*(m-1),m=1,u=W+m+65535,m=Math.floor(u/65536),W=u-m*65536,u=J+m+65535,m=Math.floor(u/65536),J=u-m*65536,u=de+m+65535,m=Math.floor(u/65536),de=u-m*65536,u=be+m+65535,m=Math.floor(u/65536),be=u-m*65536,u=ge+m+65535,m=Math.floor(u/65536),ge=u-m*65536,u=De+m+65535,m=Math.floor(u/65536),De=u-m*65536,u=$e+m+65535,m=Math.floor(u/65536),$e=u-m*65536,u=Re+m+65535,m=Math.floor(u/65536),Re=u-m*65536,u=we+m+65535,m=Math.floor(u/65536),we=u-m*65536,u=ye+m+65535,m=Math.floor(u/65536),ye=u-m*65536,u=pe+m+65535,m=Math.floor(u/65536),pe=u-m*65536,u=he+m+65535,m=Math.floor(u/65536),he=u-m*65536,u=le+m+65535,m=Math.floor(u/65536),le=u-m*65536,u=ue+m+65535,m=Math.floor(u/65536),ue=u-m*65536,u=ae+m+65535,m=Math.floor(u/65536),ae=u-m*65536,u=ie+m+65535,m=Math.floor(u/65536),ie=u-m*65536,W+=m-1+37*(m-1),T[0]=W,T[1]=J,T[2]=de,T[3]=be,T[4]=ge,T[5]=De,T[6]=$e,T[7]=Re,T[8]=we,T[9]=ye,T[10]=pe,T[11]=he,T[12]=le,T[13]=ue,T[14]=ae,T[15]=ie}function d(T,A){c(T,A,A)}function N(T,A){const x=n();let u;for(u=0;u<16;u++)x[u]=A[u];for(u=253;u>=0;u--)d(x,x),u!==2&&u!==4&&c(x,x,A);for(u=0;u<16;u++)T[u]=x[u]}function R(T,A){const x=n();let u;for(u=0;u<16;u++)x[u]=A[u];for(u=250;u>=0;u--)d(x,x),u!==1&&c(x,x,A);for(u=0;u<16;u++)T[u]=x[u]}function U(T,A){const x=n(),u=n(),m=n(),W=n(),J=n(),de=n(),be=n(),ge=n(),De=n();p(x,T[1],T[0]),p(De,A[1],A[0]),c(x,x,De),v(u,T[0],T[1]),v(De,A[0],A[1]),c(u,u,De),c(m,T[3],A[3]),c(m,m,l),c(W,T[2],A[2]),v(W,W,W),p(J,u,x),p(de,W,m),v(be,W,m),v(ge,u,x),c(T[0],J,de),c(T[1],ge,be),c(T[2],be,de),c(T[3],J,ge)}function V(T,A,x){for(let u=0;u<4;u++)C(T[u],A[u],x)}function Y(T,A){const x=n(),u=n(),m=n();N(m,A[2]),c(x,A[0],m),c(u,A[1],m),F(T,u),T[31]^=O(x)<<7}function S(T,A,x){b(T[0],o),b(T[1],a),b(T[2],a),b(T[3],o);for(let u=255;u>=0;--u){const m=x[u/8|0]>>(u&7)&1;V(T,A,m),U(A,T),U(T,T),V(T,A,m)}}function P(T,A){const x=[n(),n(),n(),n()];b(x[0],f),b(x[1],y),b(x[2],a),c(x[3],f,y),S(T,x,A)}function k(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const A=(0,r.hash)(T);A[0]&=248,A[31]&=127,A[31]|=64;const x=new Uint8Array(32),u=[n(),n(),n(),n()];P(u,A),Y(x,u);const m=new Uint8Array(64);return m.set(T),m.set(x,32),{publicKey:x,secretKey:m}}t.generateKeyPairFromSeed=k;function q(T){const A=(0,e.randomBytes)(32,T),x=k(A);return(0,i.wipe)(A),x}t.generateKeyPair=q;function $(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=$;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function L(T,A){let x,u,m,W;for(u=63;u>=32;--u){for(x=0,m=u-32,W=u-12;m<W;++m)A[m]+=x-16*A[u]*B[m-(u-32)],x=Math.floor((A[m]+128)/256),A[m]-=x*256;A[m]+=x,A[u]=0}for(x=0,m=0;m<32;m++)A[m]+=x-(A[31]>>4)*B[m],x=A[m]>>8,A[m]&=255;for(m=0;m<32;m++)A[m]-=x*B[m];for(u=0;u<32;u++)A[u+1]+=A[u]>>8,T[u]=A[u]&255}function K(T){const A=new Float64Array(64);for(let x=0;x<64;x++)A[x]=T[x];for(let x=0;x<64;x++)T[x]=0;L(T,A)}function re(T,A){const x=new Float64Array(64),u=[n(),n(),n(),n()],m=(0,r.hash)(T.subarray(0,32));m[0]&=248,m[31]&=127,m[31]|=64;const W=new Uint8Array(64);W.set(m.subarray(32),32);const J=new r.SHA512;J.update(W.subarray(32)),J.update(A);const de=J.digest();J.clean(),K(de),P(u,de),Y(W,u),J.reset(),J.update(W.subarray(0,32)),J.update(T.subarray(32)),J.update(A);const be=J.digest();K(be);for(let ge=0;ge<32;ge++)x[ge]=de[ge];for(let ge=0;ge<32;ge++)for(let De=0;De<32;De++)x[ge+De]+=be[ge]*m[De];return L(W.subarray(32),x),W}t.sign=re;function H(T,A){const x=n(),u=n(),m=n(),W=n(),J=n(),de=n(),be=n();return b(T[2],a),w(T[1],A),d(m,T[1]),c(W,m,h),p(m,m,T[2]),v(W,T[2],W),d(J,W),d(de,J),c(be,de,J),c(x,be,m),c(x,x,W),R(x,x),c(x,x,m),c(x,x,W),c(x,x,W),c(T[0],x,W),d(u,T[0]),c(u,u,W),D(u,m)&&c(T[0],T[0],_),d(u,T[0]),c(u,u,W),D(u,m)?-1:(O(T[0])===A[31]>>7&&p(T[0],o,T[0]),c(T[3],T[0],T[1]),0)}function ee(T,A,x){const u=new Uint8Array(32),m=[n(),n(),n(),n()],W=[n(),n(),n(),n()];if(x.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(H(W,T))return!1;const J=new r.SHA512;J.update(x.subarray(0,32)),J.update(T),J.update(A);const de=J.digest();return K(de),S(m,W,de),P(W,x.subarray(32)),U(m,W),Y(u,m),!z(x,u)}t.verify=ee;function X(T){let A=[n(),n(),n(),n()];if(H(A,T))throw new Error("Ed25519: invalid public key");let x=n(),u=n(),m=A[1];v(x,a,m),p(u,a,m),N(u,u),c(x,x,u);let W=new Uint8Array(32);return F(W,x),W}t.convertPublicKeyToX25519=X;function te(T){const A=(0,r.hash)(T.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const x=new Uint8Array(A.subarray(0,32));return(0,i.wipe)(A),x}t.convertSecretKeyToX25519=te})(is);const Ld="EdDSA",$d="JWT",ec=".",tc="base64url",Md="utf8",jd="utf8",Bd=":",zd="did",qd="key",wo="base58btc",Kd="z",Vd="K36",Hd=32;function ns(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function rc(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ns(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function jn(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=rc(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return ns(r)}function Wd(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,h=t.charAt(0),l=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function y(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var C=0,F=0,z=0,D=E.length;z!==D&&E[z]===0;)z++,C++;for(var O=(D-z)*f+1>>>0,w=new Uint8Array(O);z!==D;){for(var v=E[z],p=0,c=O-1;(v!==0||p<F)&&c!==-1;c--,p++)v+=256*w[c]>>>0,w[c]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");F=p,z++}for(var d=O-F;d!==O&&w[d]===0;)d++;for(var N=h.repeat(C);d<O;++d)N+=t.charAt(w[d]);return N}function _(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var C=0;if(E[C]!==" "){for(var F=0,z=0;E[C]===h;)F++,C++;for(var D=(E.length-C)*l+1>>>0,O=new Uint8Array(D);E[C];){var w=r[E.charCodeAt(C)];if(w===255)return;for(var v=0,p=D-1;(w!==0||v<z)&&p!==-1;p--,v++)w+=a*O[p]>>>0,O[p]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");z=v,C++}if(E[C]!==" "){for(var c=D-z;c!==D&&O[c]===0;)c++;for(var d=new Uint8Array(F+(D-c)),N=F;c!==D;)d[N++]=O[c++];return d}}}function b(E){var C=_(E);if(C)return C;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:_,decode:b}}var kd=Wd,Gd=kd;const Yd=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Jd=t=>new TextEncoder().encode(t),Xd=t=>new TextDecoder().decode(t);class Zd{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Qd{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ic(this,e)}}class ep{constructor(e){this.decoders=e}or(e){return ic(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ic=(t,e)=>new ep({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class tp{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Zd(e,r,i),this.decoder=new Qd(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ki=({name:t,prefix:e,encode:r,decode:i})=>new tp(t,e,r,i),ui=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Gd(r,e);return ki({prefix:t,name:e,encode:i,decode:s=>Yd(n(s))})},rp=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,l=0;for(let f=0;f<s;++f){const y=n[t[f]];if(y===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|y,a+=r,a>=8&&(a-=8,o[l++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},ip=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},st=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>ki({prefix:e,name:t,encode(n){return ip(n,i,r)},decode(n){return rp(n,i,r,t)}}),np=ki({prefix:"\0",name:"identity",encode:t=>Xd(t),decode:t=>Jd(t)});var sp=Object.freeze({__proto__:null,identity:np});const op=st({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ap=Object.freeze({__proto__:null,base2:op});const cp=st({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var up=Object.freeze({__proto__:null,base8:cp});const lp=ui({prefix:"9",name:"base10",alphabet:"0123456789"});var hp=Object.freeze({__proto__:null,base10:lp});const fp=st({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),dp=st({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var pp=Object.freeze({__proto__:null,base16:fp,base16upper:dp});const gp=st({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yp=st({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_p=st({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wp=st({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),bp=st({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mp=st({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vp=st({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ep=st({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dp=st({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Sp=Object.freeze({__proto__:null,base32:gp,base32hex:bp,base32hexpad:vp,base32hexpadupper:Ep,base32hexupper:mp,base32pad:_p,base32padupper:wp,base32upper:yp,base32z:Dp});const xp=ui({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ip=ui({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Op=Object.freeze({__proto__:null,base36:xp,base36upper:Ip});const Ap=ui({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tp=ui({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Cp=Object.freeze({__proto__:null,base58btc:Ap,base58flickr:Tp});const Pp=st({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Rp=st({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Np=st({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Fp=st({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Up=Object.freeze({__proto__:null,base64:Pp,base64pad:Rp,base64url:Np,base64urlpad:Fp});const nc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Lp=nc.reduce((t,e,r)=>(t[r]=e,t),[]),$p=nc.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Mp(t){return t.reduce((e,r)=>(e+=Lp[r],e),"")}function jp(t){const e=[];for(const r of t){const i=$p[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Bp=ki({prefix:"\u{1F680}",name:"base256emoji",encode:Mp,decode:jp});var zp=Object.freeze({__proto__:null,base256emoji:Bp});new TextEncoder;new TextDecoder;const bo={...sp,...ap,...up,...hp,...pp,...Sp,...Op,...Cp,...Up,...zp};function sc(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const mo=sc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),dn=sc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=rc(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),oc={utf8:mo,"utf-8":mo,hex:bo.base16,latin1:dn,ascii:dn,binary:dn,...bo};function _t(t,e="utf8"){const r=oc[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function bt(t,e="utf8"){const r=oc[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ns(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Pi(t){return _t(bt(rs(t),Md),tc)}function ac(t){const e=bt(Vd,wo),r=Kd+_t(jn([e,t]),wo);return[zd,qd,r].join(Bd)}function qp(t){return _t(t,tc)}function Kp(t){return bt([Pi(t.header),Pi(t.payload)].join(ec),jd)}function Vp(t){return[Pi(t.header),Pi(t.payload),qp(t.signature)].join(ec)}function vo(t=Fr.randomBytes(Hd)){return is.generateKeyPairFromSeed(t)}async function Hp(t,e,r,i,n=Q.fromMiliseconds(Date.now())){const s={alg:Ld,typ:$d},o=ac(i.publicKey),a=n+r,h={iss:o,sub:t,aud:e,iat:n,exp:a},l=Kp({header:s,payload:h}),f=is.sign(i.secretKey,l);return Vp({header:s,payload:h,signature:f})}var ss={},Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});var ut=se,Bn=St,Wp=20;function kp(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],y=r[19]<<24|r[18]<<16|r[17]<<8|r[16],_=r[23]<<24|r[22]<<16|r[21]<<8|r[20],b=r[27]<<24|r[26]<<16|r[25]<<8|r[24],E=r[31]<<24|r[30]<<16|r[29]<<8|r[28],C=e[3]<<24|e[2]<<16|e[1]<<8|e[0],F=e[7]<<24|e[6]<<16|e[5]<<8|e[4],z=e[11]<<24|e[10]<<16|e[9]<<8|e[8],D=e[15]<<24|e[14]<<16|e[13]<<8|e[12],O=i,w=n,v=s,p=o,c=a,d=h,N=l,R=f,U=y,V=_,Y=b,S=E,P=C,k=F,q=z,$=D,B=0;B<Wp;B+=2)O=O+c|0,P^=O,P=P>>>32-16|P<<16,U=U+P|0,c^=U,c=c>>>32-12|c<<12,w=w+d|0,k^=w,k=k>>>32-16|k<<16,V=V+k|0,d^=V,d=d>>>32-12|d<<12,v=v+N|0,q^=v,q=q>>>32-16|q<<16,Y=Y+q|0,N^=Y,N=N>>>32-12|N<<12,p=p+R|0,$^=p,$=$>>>32-16|$<<16,S=S+$|0,R^=S,R=R>>>32-12|R<<12,v=v+N|0,q^=v,q=q>>>32-8|q<<8,Y=Y+q|0,N^=Y,N=N>>>32-7|N<<7,p=p+R|0,$^=p,$=$>>>32-8|$<<8,S=S+$|0,R^=S,R=R>>>32-7|R<<7,w=w+d|0,k^=w,k=k>>>32-8|k<<8,V=V+k|0,d^=V,d=d>>>32-7|d<<7,O=O+c|0,P^=O,P=P>>>32-8|P<<8,U=U+P|0,c^=U,c=c>>>32-7|c<<7,O=O+d|0,$^=O,$=$>>>32-16|$<<16,Y=Y+$|0,d^=Y,d=d>>>32-12|d<<12,w=w+N|0,P^=w,P=P>>>32-16|P<<16,S=S+P|0,N^=S,N=N>>>32-12|N<<12,v=v+R|0,k^=v,k=k>>>32-16|k<<16,U=U+k|0,R^=U,R=R>>>32-12|R<<12,p=p+c|0,q^=p,q=q>>>32-16|q<<16,V=V+q|0,c^=V,c=c>>>32-12|c<<12,v=v+R|0,k^=v,k=k>>>32-8|k<<8,U=U+k|0,R^=U,R=R>>>32-7|R<<7,p=p+c|0,q^=p,q=q>>>32-8|q<<8,V=V+q|0,c^=V,c=c>>>32-7|c<<7,w=w+N|0,P^=w,P=P>>>32-8|P<<8,S=S+P|0,N^=S,N=N>>>32-7|N<<7,O=O+d|0,$^=O,$=$>>>32-8|$<<8,Y=Y+$|0,d^=Y,d=d>>>32-7|d<<7;ut.writeUint32LE(O+i|0,t,0),ut.writeUint32LE(w+n|0,t,4),ut.writeUint32LE(v+s|0,t,8),ut.writeUint32LE(p+o|0,t,12),ut.writeUint32LE(c+a|0,t,16),ut.writeUint32LE(d+h|0,t,20),ut.writeUint32LE(N+l|0,t,24),ut.writeUint32LE(R+f|0,t,28),ut.writeUint32LE(U+y|0,t,32),ut.writeUint32LE(V+_|0,t,36),ut.writeUint32LE(Y+b|0,t,40),ut.writeUint32LE(S+E|0,t,44),ut.writeUint32LE(P+C|0,t,48),ut.writeUint32LE(k+F|0,t,52),ut.writeUint32LE(q+z|0,t,56),ut.writeUint32LE($+D|0,t,60)}function cc(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),h=0;h<r.length;h+=64){kp(a,s,t);for(var l=h;l<h+64&&l<r.length;l++)i[l]=r[l]^a[l-h];Yp(s,0,o)}return Bn.wipe(a),n===0&&Bn.wipe(s),i}Gi.streamXOR=cc;function Gp(t,e,r,i){return i===void 0&&(i=0),Bn.wipe(r),cc(t,e,r,r,i)}Gi.stream=Gp;function Yp(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var uc={},sr={};Object.defineProperty(sr,"__esModule",{value:!0});function Jp(t,e,r){return~(t-1)&e|t-1&r}sr.select=Jp;function Xp(t,e){return(t|0)-(e|0)-1>>>31&1}sr.lessOrEqual=Xp;function lc(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}sr.compare=lc;function Zp(t,e){return t.length===0||e.length===0?!1:lc(t,e)!==0}sr.equal=Zp;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=sr,r=St;t.DIGEST_LENGTH=16;var i=function(){function o(a){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=a[0]|a[1]<<8;this._r[0]=h&8191;var l=a[2]|a[3]<<8;this._r[1]=(h>>>13|l<<3)&8191;var f=a[4]|a[5]<<8;this._r[2]=(l>>>10|f<<6)&7939;var y=a[6]|a[7]<<8;this._r[3]=(f>>>7|y<<9)&8191;var _=a[8]|a[9]<<8;this._r[4]=(y>>>4|_<<12)&255,this._r[5]=_>>>1&8190;var b=a[10]|a[11]<<8;this._r[6]=(_>>>14|b<<2)&8191;var E=a[12]|a[13]<<8;this._r[7]=(b>>>11|E<<5)&8065;var C=a[14]|a[15]<<8;this._r[8]=(E>>>8|C<<8)&8191,this._r[9]=C>>>5&127,this._pad[0]=a[16]|a[17]<<8,this._pad[1]=a[18]|a[19]<<8,this._pad[2]=a[20]|a[21]<<8,this._pad[3]=a[22]|a[23]<<8,this._pad[4]=a[24]|a[25]<<8,this._pad[5]=a[26]|a[27]<<8,this._pad[6]=a[28]|a[29]<<8,this._pad[7]=a[30]|a[31]<<8}return o.prototype._blocks=function(a,h,l){for(var f=this._fin?0:2048,y=this._h[0],_=this._h[1],b=this._h[2],E=this._h[3],C=this._h[4],F=this._h[5],z=this._h[6],D=this._h[7],O=this._h[8],w=this._h[9],v=this._r[0],p=this._r[1],c=this._r[2],d=this._r[3],N=this._r[4],R=this._r[5],U=this._r[6],V=this._r[7],Y=this._r[8],S=this._r[9];l>=16;){var P=a[h+0]|a[h+1]<<8;y+=P&8191;var k=a[h+2]|a[h+3]<<8;_+=(P>>>13|k<<3)&8191;var q=a[h+4]|a[h+5]<<8;b+=(k>>>10|q<<6)&8191;var $=a[h+6]|a[h+7]<<8;E+=(q>>>7|$<<9)&8191;var B=a[h+8]|a[h+9]<<8;C+=($>>>4|B<<12)&8191,F+=B>>>1&8191;var L=a[h+10]|a[h+11]<<8;z+=(B>>>14|L<<2)&8191;var K=a[h+12]|a[h+13]<<8;D+=(L>>>11|K<<5)&8191;var re=a[h+14]|a[h+15]<<8;O+=(K>>>8|re<<8)&8191,w+=re>>>5|f;var H=0,ee=H;ee+=y*v,ee+=_*(5*S),ee+=b*(5*Y),ee+=E*(5*V),ee+=C*(5*U),H=ee>>>13,ee&=8191,ee+=F*(5*R),ee+=z*(5*N),ee+=D*(5*d),ee+=O*(5*c),ee+=w*(5*p),H+=ee>>>13,ee&=8191;var X=H;X+=y*p,X+=_*v,X+=b*(5*S),X+=E*(5*Y),X+=C*(5*V),H=X>>>13,X&=8191,X+=F*(5*U),X+=z*(5*R),X+=D*(5*N),X+=O*(5*d),X+=w*(5*c),H+=X>>>13,X&=8191;var te=H;te+=y*c,te+=_*p,te+=b*v,te+=E*(5*S),te+=C*(5*Y),H=te>>>13,te&=8191,te+=F*(5*V),te+=z*(5*U),te+=D*(5*R),te+=O*(5*N),te+=w*(5*d),H+=te>>>13,te&=8191;var T=H;T+=y*d,T+=_*c,T+=b*p,T+=E*v,T+=C*(5*S),H=T>>>13,T&=8191,T+=F*(5*Y),T+=z*(5*V),T+=D*(5*U),T+=O*(5*R),T+=w*(5*N),H+=T>>>13,T&=8191;var A=H;A+=y*N,A+=_*d,A+=b*c,A+=E*p,A+=C*v,H=A>>>13,A&=8191,A+=F*(5*S),A+=z*(5*Y),A+=D*(5*V),A+=O*(5*U),A+=w*(5*R),H+=A>>>13,A&=8191;var x=H;x+=y*R,x+=_*N,x+=b*d,x+=E*c,x+=C*p,H=x>>>13,x&=8191,x+=F*v,x+=z*(5*S),x+=D*(5*Y),x+=O*(5*V),x+=w*(5*U),H+=x>>>13,x&=8191;var u=H;u+=y*U,u+=_*R,u+=b*N,u+=E*d,u+=C*c,H=u>>>13,u&=8191,u+=F*p,u+=z*v,u+=D*(5*S),u+=O*(5*Y),u+=w*(5*V),H+=u>>>13,u&=8191;var m=H;m+=y*V,m+=_*U,m+=b*R,m+=E*N,m+=C*d,H=m>>>13,m&=8191,m+=F*c,m+=z*p,m+=D*v,m+=O*(5*S),m+=w*(5*Y),H+=m>>>13,m&=8191;var W=H;W+=y*Y,W+=_*V,W+=b*U,W+=E*R,W+=C*N,H=W>>>13,W&=8191,W+=F*d,W+=z*c,W+=D*p,W+=O*v,W+=w*(5*S),H+=W>>>13,W&=8191;var J=H;J+=y*S,J+=_*Y,J+=b*V,J+=E*U,J+=C*R,H=J>>>13,J&=8191,J+=F*N,J+=z*d,J+=D*c,J+=O*p,J+=w*v,H+=J>>>13,J&=8191,H=(H<<2)+H|0,H=H+ee|0,ee=H&8191,H=H>>>13,X+=H,y=ee,_=X,b=te,E=T,C=A,F=x,z=u,D=m,O=W,w=J,h+=16,l-=16}this._h[0]=y,this._h[1]=_,this._h[2]=b,this._h[3]=E,this._h[4]=C,this._h[5]=F,this._h[6]=z,this._h[7]=D,this._h[8]=O,this._h[9]=w},o.prototype.finish=function(a,h){h===void 0&&(h=0);var l=new Uint16Array(10),f,y,_,b;if(this._leftover){for(b=this._leftover,this._buffer[b++]=1;b<16;b++)this._buffer[b]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,b=2;b<10;b++)this._h[b]+=f,f=this._h[b]>>>13,this._h[b]&=8191;for(this._h[0]+=f*5,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,l[0]=this._h[0]+5,f=l[0]>>>13,l[0]&=8191,b=1;b<10;b++)l[b]=this._h[b]+f,f=l[b]>>>13,l[b]&=8191;for(l[9]-=1<<13,y=(f^1)-1,b=0;b<10;b++)l[b]&=y;for(y=~y,b=0;b<10;b++)this._h[b]=this._h[b]&y|l[b];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,_=this._h[0]+this._pad[0],this._h[0]=_&65535,b=1;b<8;b++)_=(this._h[b]+this._pad[b]|0)+(_>>>16)|0,this._h[b]=_&65535;return a[h+0]=this._h[0]>>>0,a[h+1]=this._h[0]>>>8,a[h+2]=this._h[1]>>>0,a[h+3]=this._h[1]>>>8,a[h+4]=this._h[2]>>>0,a[h+5]=this._h[2]>>>8,a[h+6]=this._h[3]>>>0,a[h+7]=this._h[3]>>>8,a[h+8]=this._h[4]>>>0,a[h+9]=this._h[4]>>>8,a[h+10]=this._h[5]>>>0,a[h+11]=this._h[5]>>>8,a[h+12]=this._h[6]>>>0,a[h+13]=this._h[6]>>>8,a[h+14]=this._h[7]>>>0,a[h+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(a){var h=0,l=a.length,f;if(this._leftover){f=16-this._leftover,f>l&&(f=l);for(var y=0;y<f;y++)this._buffer[this._leftover+y]=a[h+y];if(l-=f,h+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(f=l-l%16,this._blocks(a,h,f),h+=f,l-=f),l){for(var y=0;y<l;y++)this._buffer[this._leftover+y]=a[h+y];this._leftover+=l}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var a=new Uint8Array(16);return this.finish(a),a},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();t.Poly1305=i;function n(o,a){var h=new i(o);h.update(a);var l=h.digest();return h.clean(),l}t.oneTimeAuth=n;function s(o,a){return o.length!==t.DIGEST_LENGTH||a.length!==t.DIGEST_LENGTH?!1:e.equal(o,a)}t.equal=s})(uc);(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Gi,r=uc,i=St,n=se,s=sr;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),a=function(){function h(l){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,l.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return h.prototype.seal=function(l,f,y,_){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var b=new Uint8Array(16);b.set(l,b.length-l.length);var E=new Uint8Array(32);e.stream(this._key,b,E,4);var C=f.length+this.tagLength,F;if(_){if(_.length!==C)throw new Error("ChaCha20Poly1305: incorrect destination length");F=_}else F=new Uint8Array(C);return e.streamXOR(this._key,b,f,F,4),this._authenticate(F.subarray(F.length-this.tagLength,F.length),E,F.subarray(0,F.length-this.tagLength),y),i.wipe(b),F},h.prototype.open=function(l,f,y,_){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var b=new Uint8Array(16);b.set(l,b.length-l.length);var E=new Uint8Array(32);e.stream(this._key,b,E,4);var C=new Uint8Array(this.tagLength);if(this._authenticate(C,E,f.subarray(0,f.length-this.tagLength),y),!s.equal(C,f.subarray(f.length-this.tagLength,f.length)))return null;var F=f.length-this.tagLength,z;if(_){if(_.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");z=_}else z=new Uint8Array(F);return e.streamXOR(this._key,b,f.subarray(0,f.length-this.tagLength),z,4),i.wipe(b),z},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(l,f,y,_){var b=new r.Poly1305(f);_&&(b.update(_),_.length%16>0&&b.update(o.subarray(_.length%16))),b.update(y),y.length%16>0&&b.update(o.subarray(y.length%16));var E=new Uint8Array(8);_&&n.writeUint64LE(_.length,E),b.update(E),n.writeUint64LE(y.length,E),b.update(E);for(var C=b.digest(),F=0;F<C.length;F++)l[F]=C[F];b.clean(),i.wipe(C),i.wipe(E)},h}();t.ChaCha20Poly1305=a})(ss);var hc={},li={},os={};Object.defineProperty(os,"__esModule",{value:!0});function Qp(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}os.isSerializableHash=Qp;Object.defineProperty(li,"__esModule",{value:!0});var Mt=os,e0=sr,t0=St,fc=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Mt.isSerializableHash(this._inner)&&Mt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),t0.wipe(i)}return t.prototype.reset=function(){if(!Mt.isSerializableHash(this._inner)||!Mt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Mt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Mt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Mt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Mt.isSerializableHash(this._inner)||!Mt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Mt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();li.HMAC=fc;function r0(t,e,r){var i=new fc(t,e);i.update(r);var n=i.digest();return i.clean(),n}li.hmac=r0;li.equal=e0.equal;Object.defineProperty(hc,"__esModule",{value:!0});var Eo=li,Do=St,i0=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=Eo.hmac(this._hash,i,r);this._hmac=new Eo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Do.wipe(this._buffer),Do.wipe(this._counter),this._bufpos=0},t}(),n0=hc.HKDF=i0,Yi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=se,r=St;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},a.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=s(this._temp,this._state,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},a.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,y=l/536870912|0,_=l<<3,b=l%64<56?64:128;this._buffer[f]=128;for(var E=f+1;E<b-8;E++)this._buffer[E]=0;e.writeUint32BE(y,this._buffer,b-8),e.writeUint32BE(_,this._buffer,b-4),s(this._temp,this._state,this._buffer,0,b),this._finished=!0}for(var E=0;E<this.digestLength/4;E++)e.writeUint32BE(this._state[E],h,E*4);return this},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},a}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(a,h,l,f,y){for(;y>=64;){for(var _=h[0],b=h[1],E=h[2],C=h[3],F=h[4],z=h[5],D=h[6],O=h[7],w=0;w<16;w++){var v=f+w*4;a[w]=e.readUint32BE(l,v)}for(var w=16;w<64;w++){var p=a[w-2],c=(p>>>17|p<<32-17)^(p>>>19|p<<32-19)^p>>>10;p=a[w-15];var d=(p>>>7|p<<32-7)^(p>>>18|p<<32-18)^p>>>3;a[w]=(c+a[w-7]|0)+(d+a[w-16]|0)}for(var w=0;w<64;w++){var c=(((F>>>6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7))+(F&z^~F&D)|0)+(O+(n[w]+a[w]|0)|0)|0,d=((_>>>2|_<<32-2)^(_>>>13|_<<32-13)^(_>>>22|_<<32-22))+(_&b^_&E^b&E)|0;O=D,D=z,z=F,F=C+c|0,C=E,E=b,b=_,_=c+d|0}h[0]+=_,h[1]+=b,h[2]+=E,h[3]+=C,h[4]+=F,h[5]+=z,h[6]+=D,h[7]+=O,f+=64,y-=64}return f}function o(a){var h=new i;h.update(a);var l=h.digest();return h.clean(),l}t.hash=o})(Yi);var as={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=Fr,r=St;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(w){const v=new Float64Array(16);if(w)for(let p=0;p<w.length;p++)v[p]=w[p];return v}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function o(w){let v=1;for(let p=0;p<16;p++){let c=w[p]+v+65535;v=Math.floor(c/65536),w[p]=c-v*65536}w[0]+=v-1+37*(v-1)}function a(w,v,p){const c=~(p-1);for(let d=0;d<16;d++){const N=c&(w[d]^v[d]);w[d]^=N,v[d]^=N}}function h(w,v){const p=i(),c=i();for(let d=0;d<16;d++)c[d]=v[d];o(c),o(c),o(c);for(let d=0;d<2;d++){p[0]=c[0]-65517;for(let R=1;R<15;R++)p[R]=c[R]-65535-(p[R-1]>>16&1),p[R-1]&=65535;p[15]=c[15]-32767-(p[14]>>16&1);const N=p[15]>>16&1;p[14]&=65535,a(c,p,1-N)}for(let d=0;d<16;d++)w[2*d]=c[d]&255,w[2*d+1]=c[d]>>8}function l(w,v){for(let p=0;p<16;p++)w[p]=v[2*p]+(v[2*p+1]<<8);w[15]&=32767}function f(w,v,p){for(let c=0;c<16;c++)w[c]=v[c]+p[c]}function y(w,v,p){for(let c=0;c<16;c++)w[c]=v[c]-p[c]}function _(w,v,p){let c,d,N=0,R=0,U=0,V=0,Y=0,S=0,P=0,k=0,q=0,$=0,B=0,L=0,K=0,re=0,H=0,ee=0,X=0,te=0,T=0,A=0,x=0,u=0,m=0,W=0,J=0,de=0,be=0,ge=0,De=0,$e=0,Re=0,we=p[0],ye=p[1],pe=p[2],he=p[3],le=p[4],ue=p[5],ae=p[6],ie=p[7],fe=p[8],_e=p[9],ne=p[10],me=p[11],Ee=p[12],xe=p[13],Ie=p[14],Se=p[15];c=v[0],N+=c*we,R+=c*ye,U+=c*pe,V+=c*he,Y+=c*le,S+=c*ue,P+=c*ae,k+=c*ie,q+=c*fe,$+=c*_e,B+=c*ne,L+=c*me,K+=c*Ee,re+=c*xe,H+=c*Ie,ee+=c*Se,c=v[1],R+=c*we,U+=c*ye,V+=c*pe,Y+=c*he,S+=c*le,P+=c*ue,k+=c*ae,q+=c*ie,$+=c*fe,B+=c*_e,L+=c*ne,K+=c*me,re+=c*Ee,H+=c*xe,ee+=c*Ie,X+=c*Se,c=v[2],U+=c*we,V+=c*ye,Y+=c*pe,S+=c*he,P+=c*le,k+=c*ue,q+=c*ae,$+=c*ie,B+=c*fe,L+=c*_e,K+=c*ne,re+=c*me,H+=c*Ee,ee+=c*xe,X+=c*Ie,te+=c*Se,c=v[3],V+=c*we,Y+=c*ye,S+=c*pe,P+=c*he,k+=c*le,q+=c*ue,$+=c*ae,B+=c*ie,L+=c*fe,K+=c*_e,re+=c*ne,H+=c*me,ee+=c*Ee,X+=c*xe,te+=c*Ie,T+=c*Se,c=v[4],Y+=c*we,S+=c*ye,P+=c*pe,k+=c*he,q+=c*le,$+=c*ue,B+=c*ae,L+=c*ie,K+=c*fe,re+=c*_e,H+=c*ne,ee+=c*me,X+=c*Ee,te+=c*xe,T+=c*Ie,A+=c*Se,c=v[5],S+=c*we,P+=c*ye,k+=c*pe,q+=c*he,$+=c*le,B+=c*ue,L+=c*ae,K+=c*ie,re+=c*fe,H+=c*_e,ee+=c*ne,X+=c*me,te+=c*Ee,T+=c*xe,A+=c*Ie,x+=c*Se,c=v[6],P+=c*we,k+=c*ye,q+=c*pe,$+=c*he,B+=c*le,L+=c*ue,K+=c*ae,re+=c*ie,H+=c*fe,ee+=c*_e,X+=c*ne,te+=c*me,T+=c*Ee,A+=c*xe,x+=c*Ie,u+=c*Se,c=v[7],k+=c*we,q+=c*ye,$+=c*pe,B+=c*he,L+=c*le,K+=c*ue,re+=c*ae,H+=c*ie,ee+=c*fe,X+=c*_e,te+=c*ne,T+=c*me,A+=c*Ee,x+=c*xe,u+=c*Ie,m+=c*Se,c=v[8],q+=c*we,$+=c*ye,B+=c*pe,L+=c*he,K+=c*le,re+=c*ue,H+=c*ae,ee+=c*ie,X+=c*fe,te+=c*_e,T+=c*ne,A+=c*me,x+=c*Ee,u+=c*xe,m+=c*Ie,W+=c*Se,c=v[9],$+=c*we,B+=c*ye,L+=c*pe,K+=c*he,re+=c*le,H+=c*ue,ee+=c*ae,X+=c*ie,te+=c*fe,T+=c*_e,A+=c*ne,x+=c*me,u+=c*Ee,m+=c*xe,W+=c*Ie,J+=c*Se,c=v[10],B+=c*we,L+=c*ye,K+=c*pe,re+=c*he,H+=c*le,ee+=c*ue,X+=c*ae,te+=c*ie,T+=c*fe,A+=c*_e,x+=c*ne,u+=c*me,m+=c*Ee,W+=c*xe,J+=c*Ie,de+=c*Se,c=v[11],L+=c*we,K+=c*ye,re+=c*pe,H+=c*he,ee+=c*le,X+=c*ue,te+=c*ae,T+=c*ie,A+=c*fe,x+=c*_e,u+=c*ne,m+=c*me,W+=c*Ee,J+=c*xe,de+=c*Ie,be+=c*Se,c=v[12],K+=c*we,re+=c*ye,H+=c*pe,ee+=c*he,X+=c*le,te+=c*ue,T+=c*ae,A+=c*ie,x+=c*fe,u+=c*_e,m+=c*ne,W+=c*me,J+=c*Ee,de+=c*xe,be+=c*Ie,ge+=c*Se,c=v[13],re+=c*we,H+=c*ye,ee+=c*pe,X+=c*he,te+=c*le,T+=c*ue,A+=c*ae,x+=c*ie,u+=c*fe,m+=c*_e,W+=c*ne,J+=c*me,de+=c*Ee,be+=c*xe,ge+=c*Ie,De+=c*Se,c=v[14],H+=c*we,ee+=c*ye,X+=c*pe,te+=c*he,T+=c*le,A+=c*ue,x+=c*ae,u+=c*ie,m+=c*fe,W+=c*_e,J+=c*ne,de+=c*me,be+=c*Ee,ge+=c*xe,De+=c*Ie,$e+=c*Se,c=v[15],ee+=c*we,X+=c*ye,te+=c*pe,T+=c*he,A+=c*le,x+=c*ue,u+=c*ae,m+=c*ie,W+=c*fe,J+=c*_e,de+=c*ne,be+=c*me,ge+=c*Ee,De+=c*xe,$e+=c*Ie,Re+=c*Se,N+=38*X,R+=38*te,U+=38*T,V+=38*A,Y+=38*x,S+=38*u,P+=38*m,k+=38*W,q+=38*J,$+=38*de,B+=38*be,L+=38*ge,K+=38*De,re+=38*$e,H+=38*Re,d=1,c=N+d+65535,d=Math.floor(c/65536),N=c-d*65536,c=R+d+65535,d=Math.floor(c/65536),R=c-d*65536,c=U+d+65535,d=Math.floor(c/65536),U=c-d*65536,c=V+d+65535,d=Math.floor(c/65536),V=c-d*65536,c=Y+d+65535,d=Math.floor(c/65536),Y=c-d*65536,c=S+d+65535,d=Math.floor(c/65536),S=c-d*65536,c=P+d+65535,d=Math.floor(c/65536),P=c-d*65536,c=k+d+65535,d=Math.floor(c/65536),k=c-d*65536,c=q+d+65535,d=Math.floor(c/65536),q=c-d*65536,c=$+d+65535,d=Math.floor(c/65536),$=c-d*65536,c=B+d+65535,d=Math.floor(c/65536),B=c-d*65536,c=L+d+65535,d=Math.floor(c/65536),L=c-d*65536,c=K+d+65535,d=Math.floor(c/65536),K=c-d*65536,c=re+d+65535,d=Math.floor(c/65536),re=c-d*65536,c=H+d+65535,d=Math.floor(c/65536),H=c-d*65536,c=ee+d+65535,d=Math.floor(c/65536),ee=c-d*65536,N+=d-1+37*(d-1),d=1,c=N+d+65535,d=Math.floor(c/65536),N=c-d*65536,c=R+d+65535,d=Math.floor(c/65536),R=c-d*65536,c=U+d+65535,d=Math.floor(c/65536),U=c-d*65536,c=V+d+65535,d=Math.floor(c/65536),V=c-d*65536,c=Y+d+65535,d=Math.floor(c/65536),Y=c-d*65536,c=S+d+65535,d=Math.floor(c/65536),S=c-d*65536,c=P+d+65535,d=Math.floor(c/65536),P=c-d*65536,c=k+d+65535,d=Math.floor(c/65536),k=c-d*65536,c=q+d+65535,d=Math.floor(c/65536),q=c-d*65536,c=$+d+65535,d=Math.floor(c/65536),$=c-d*65536,c=B+d+65535,d=Math.floor(c/65536),B=c-d*65536,c=L+d+65535,d=Math.floor(c/65536),L=c-d*65536,c=K+d+65535,d=Math.floor(c/65536),K=c-d*65536,c=re+d+65535,d=Math.floor(c/65536),re=c-d*65536,c=H+d+65535,d=Math.floor(c/65536),H=c-d*65536,c=ee+d+65535,d=Math.floor(c/65536),ee=c-d*65536,N+=d-1+37*(d-1),w[0]=N,w[1]=R,w[2]=U,w[3]=V,w[4]=Y,w[5]=S,w[6]=P,w[7]=k,w[8]=q,w[9]=$,w[10]=B,w[11]=L,w[12]=K,w[13]=re,w[14]=H,w[15]=ee}function b(w,v){_(w,v,v)}function E(w,v){const p=i();for(let c=0;c<16;c++)p[c]=v[c];for(let c=253;c>=0;c--)b(p,p),c!==2&&c!==4&&_(p,p,v);for(let c=0;c<16;c++)w[c]=p[c]}function C(w,v){const p=new Uint8Array(32),c=new Float64Array(80),d=i(),N=i(),R=i(),U=i(),V=i(),Y=i();for(let q=0;q<31;q++)p[q]=w[q];p[31]=w[31]&127|64,p[0]&=248,l(c,v);for(let q=0;q<16;q++)N[q]=c[q];d[0]=U[0]=1;for(let q=254;q>=0;--q){const $=p[q>>>3]>>>(q&7)&1;a(d,N,$),a(R,U,$),f(V,d,R),y(d,d,R),f(R,N,U),y(N,N,U),b(U,V),b(Y,d),_(d,R,d),_(R,N,V),f(V,d,R),y(d,d,R),b(N,d),y(R,U,Y),_(d,R,s),f(d,d,U),_(R,R,d),_(d,U,Y),_(U,N,c),b(N,V),a(d,N,$),a(R,U,$)}for(let q=0;q<16;q++)c[q+16]=d[q],c[q+32]=R[q],c[q+48]=N[q],c[q+64]=U[q];const S=c.subarray(32),P=c.subarray(16);E(S,S),_(P,P,S);const k=new Uint8Array(32);return h(k,P),k}t.scalarMult=C;function F(w){return C(w,n)}t.scalarMultBase=F;function z(w){if(w.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(w);return{publicKey:F(v),secretKey:v}}t.generateKeyPairFromSeed=z;function D(w){const v=(0,e.randomBytes)(32,w),p=z(v);return(0,r.wipe)(v),p}t.generateKeyPair=D;function O(w,v,p=!1){if(w.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=C(w,v);if(p){let d=0;for(let N=0;N<c.length;N++)d|=c[N];if(d===0)throw new Error("X25519: invalid shared key")}return c}t.sharedKey=O})(as);var So=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},s0=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),o0=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),a0=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),c0=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),u0=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),l0=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,h0=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,xo=3,f0=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",l0]],Io=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function d0(t){return t?Oo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new u0:typeof navigator<"u"?Oo(navigator.userAgent):y0()}function p0(t){return t!==""&&f0.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Oo(t){var e=p0(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new c0;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<xo&&(n=So(So([],n,!0),_0(xo-n.length),!0)):n=[];var s=n.join("."),o=g0(t),a=h0.exec(t);return a&&a[1]?new a0(r,s,o,a[1]):new s0(r,s,o)}function g0(t){for(var e=0,r=Io.length;e<r;e++){var i=Io[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function y0(){var t=typeof process<"u"&&process.version;return t?new o0(process.version.slice(1)):null}function _0(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=pc=Oe.getLocation=Oe.getLocationOrThrow=cs=Oe.getNavigator=Oe.getNavigatorOrThrow=dc=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Dr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Dr;function Ur(t){const e=Dr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=Ur;function w0(){return Ur("document")}Oe.getDocumentOrThrow=w0;function b0(){return Dr("document")}var dc=Oe.getDocument=b0;function m0(){return Ur("navigator")}Oe.getNavigatorOrThrow=m0;function v0(){return Dr("navigator")}var cs=Oe.getNavigator=v0;function E0(){return Ur("location")}Oe.getLocationOrThrow=E0;function D0(){return Dr("location")}var pc=Oe.getLocation=D0;function S0(){return Ur("crypto")}Oe.getCryptoOrThrow=S0;function x0(){return Dr("crypto")}Oe.getCrypto=x0;function I0(){return Ur("localStorage")}Oe.getLocalStorageOrThrow=I0;function O0(){return Dr("localStorage")}Oe.getLocalStorage=O0;var us={};Object.defineProperty(us,"__esModule",{value:!0});var gc=us.getWindowMetadata=void 0;const Ao=Oe;function A0(){let t,e;try{t=Ao.getDocumentOrThrow(),e=Ao.getLocationOrThrow()}catch{return null}function r(){const y=t.getElementsByTagName("link"),_=[];for(let b=0;b<y.length;b++){const E=y[b],C=E.getAttribute("rel");if(C&&C.toLowerCase().indexOf("icon")>-1){const F=E.getAttribute("href");if(F)if(F.toLowerCase().indexOf("https:")===-1&&F.toLowerCase().indexOf("http:")===-1&&F.indexOf("//")!==0){let z=e.protocol+"//"+e.host;if(F.indexOf("/")===0)z+=F;else{const D=e.pathname.split("/");D.pop();const O=D.join("/");z+=O+"/"+F}_.push(z)}else if(F.indexOf("//")===0){const z=e.protocol+F;_.push(z)}else _.push(F)}}return _}function i(...y){const _=t.getElementsByTagName("meta");for(let b=0;b<_.length;b++){const E=_[b],C=["itemprop","property","name"].map(F=>E.getAttribute(F)).filter(F=>F?y.includes(F):!1);if(C.length&&C){const F=E.getAttribute("content");if(F)return F}}return""}function n(){let y=i("name","og:site_name","og:title","twitter:title");return y||(y=t.title),y}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),a=s(),h=e.origin,l=r();return{description:a,url:h,icons:l,name:o}}gc=us.getWindowMetadata=A0;var si={},T0=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),yc="%[a-f0-9]{2}",To=new RegExp("("+yc+")|([^%]+?)","gi"),Co=new RegExp("("+yc+")+","gi");function zn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],zn(r),zn(i))}function C0(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(To)||[],r=1;r<e.length;r++)t=zn(e,r).join(""),e=t.match(To)||[];return t}}function P0(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Co.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=C0(r[0]);i!==r[0]&&(e[r[0]]=i)}r=Co.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var o=n[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var R0=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return P0(t)}},N0=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},F0=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var o=i[s],a=t[o];(n?e.indexOf(o)!==-1:e(o,a,t))&&(r[o]=a)}return r};(function(t){const e=T0,r=R0,i=N0,n=F0,s=D=>D==null,o=Symbol("encodeFragmentIdentifier");function a(D){switch(D.arrayFormat){case"index":return O=>(w,v)=>{const p=w.length;return v===void 0||D.skipNull&&v===null||D.skipEmptyString&&v===""?w:v===null?[...w,[f(O,D),"[",p,"]"].join("")]:[...w,[f(O,D),"[",f(p,D),"]=",f(v,D)].join("")]};case"bracket":return O=>(w,v)=>v===void 0||D.skipNull&&v===null||D.skipEmptyString&&v===""?w:v===null?[...w,[f(O,D),"[]"].join("")]:[...w,[f(O,D),"[]=",f(v,D)].join("")];case"colon-list-separator":return O=>(w,v)=>v===void 0||D.skipNull&&v===null||D.skipEmptyString&&v===""?w:v===null?[...w,[f(O,D),":list="].join("")]:[...w,[f(O,D),":list=",f(v,D)].join("")];case"comma":case"separator":case"bracket-separator":{const O=D.arrayFormat==="bracket-separator"?"[]=":"=";return w=>(v,p)=>p===void 0||D.skipNull&&p===null||D.skipEmptyString&&p===""?v:(p=p===null?"":p,v.length===0?[[f(w,D),O,f(p,D)].join("")]:[[v,f(p,D)].join(D.arrayFormatSeparator)])}default:return O=>(w,v)=>v===void 0||D.skipNull&&v===null||D.skipEmptyString&&v===""?w:v===null?[...w,f(O,D)]:[...w,[f(O,D),"=",f(v,D)].join("")]}}function h(D){let O;switch(D.arrayFormat){case"index":return(w,v,p)=>{if(O=/\[(\d*)\]$/.exec(w),w=w.replace(/\[\d*\]$/,""),!O){p[w]=v;return}p[w]===void 0&&(p[w]={}),p[w][O[1]]=v};case"bracket":return(w,v,p)=>{if(O=/(\[\])$/.exec(w),w=w.replace(/\[\]$/,""),!O){p[w]=v;return}if(p[w]===void 0){p[w]=[v];return}p[w]=[].concat(p[w],v)};case"colon-list-separator":return(w,v,p)=>{if(O=/(:list)$/.exec(w),w=w.replace(/:list$/,""),!O){p[w]=v;return}if(p[w]===void 0){p[w]=[v];return}p[w]=[].concat(p[w],v)};case"comma":case"separator":return(w,v,p)=>{const c=typeof v=="string"&&v.includes(D.arrayFormatSeparator),d=typeof v=="string"&&!c&&y(v,D).includes(D.arrayFormatSeparator);v=d?y(v,D):v;const N=c||d?v.split(D.arrayFormatSeparator).map(R=>y(R,D)):v===null?v:y(v,D);p[w]=N};case"bracket-separator":return(w,v,p)=>{const c=/(\[\])$/.test(w);if(w=w.replace(/\[\]$/,""),!c){p[w]=v&&y(v,D);return}const d=v===null?[]:v.split(D.arrayFormatSeparator).map(N=>y(N,D));if(p[w]===void 0){p[w]=d;return}p[w]=[].concat(p[w],d)};default:return(w,v,p)=>{if(p[w]===void 0){p[w]=v;return}p[w]=[].concat(p[w],v)}}}function l(D){if(typeof D!="string"||D.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(D,O){return O.encode?O.strict?e(D):encodeURIComponent(D):D}function y(D,O){return O.decode?r(D):D}function _(D){return Array.isArray(D)?D.sort():typeof D=="object"?_(Object.keys(D)).sort((O,w)=>Number(O)-Number(w)).map(O=>D[O]):D}function b(D){const O=D.indexOf("#");return O!==-1&&(D=D.slice(0,O)),D}function E(D){let O="";const w=D.indexOf("#");return w!==-1&&(O=D.slice(w)),O}function C(D){D=b(D);const O=D.indexOf("?");return O===-1?"":D.slice(O+1)}function F(D,O){return O.parseNumbers&&!Number.isNaN(Number(D))&&typeof D=="string"&&D.trim()!==""?D=Number(D):O.parseBooleans&&D!==null&&(D.toLowerCase()==="true"||D.toLowerCase()==="false")&&(D=D.toLowerCase()==="true"),D}function z(D,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),l(O.arrayFormatSeparator);const w=h(O),v=Object.create(null);if(typeof D!="string"||(D=D.trim().replace(/^[?#&]/,""),!D))return v;for(const p of D.split("&")){if(p==="")continue;let[c,d]=i(O.decode?p.replace(/\+/g," "):p,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?d:y(d,O),w(y(c,O),d,v)}for(const p of Object.keys(v)){const c=v[p];if(typeof c=="object"&&c!==null)for(const d of Object.keys(c))c[d]=F(c[d],O);else v[p]=F(c,O)}return O.sort===!1?v:(O.sort===!0?Object.keys(v).sort():Object.keys(v).sort(O.sort)).reduce((p,c)=>{const d=v[c];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?p[c]=_(d):p[c]=d,p},Object.create(null))}t.extract=C,t.parse=z,t.stringify=(D,O)=>{if(!D)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),l(O.arrayFormatSeparator);const w=d=>O.skipNull&&s(D[d])||O.skipEmptyString&&D[d]==="",v=a(O),p={};for(const d of Object.keys(D))w(d)||(p[d]=D[d]);const c=Object.keys(p);return O.sort!==!1&&c.sort(O.sort),c.map(d=>{const N=D[d];return N===void 0?"":N===null?f(d,O):Array.isArray(N)?N.length===0&&O.arrayFormat==="bracket-separator"?f(d,O)+"[]":N.reduce(v(d),[]).join("&"):f(d,O)+"="+f(N,O)}).filter(d=>d.length>0).join("&")},t.parseUrl=(D,O)=>{O=Object.assign({decode:!0},O);const[w,v]=i(D,"#");return Object.assign({url:w.split("?")[0]||"",query:z(C(D),O)},O&&O.parseFragmentIdentifier&&v?{fragmentIdentifier:y(v,O)}:{})},t.stringifyUrl=(D,O)=>{O=Object.assign({encode:!0,strict:!0,[o]:!0},O);const w=b(D.url).split("?")[0]||"",v=t.extract(D.url),p=t.parse(v,{sort:!1}),c=Object.assign(p,D.query);let d=t.stringify(c,O);d&&(d=`?${d}`);let N=E(D.url);return D.fragmentIdentifier&&(N=`#${O[o]?f(D.fragmentIdentifier,O):D.fragmentIdentifier}`),`${w}${d}${N}`},t.pick=(D,O,w)=>{w=Object.assign({parseFragmentIdentifier:!0,[o]:!1},w);const{url:v,query:p,fragmentIdentifier:c}=t.parseUrl(D,w);return t.stringifyUrl({url:v,query:n(p,O),fragmentIdentifier:c},w)},t.exclude=(D,O,w)=>{const v=Array.isArray(O)?p=>!O.includes(p):(p,c)=>!O(p,c);return t.pick(D,v,w)}})(si);const U0={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function _c(t,e){return t.includes(":")?[t]:e.chains||[]}const wc="base10",yt="base16",qn="base64pad",ls="utf8",bc=0,Sr=1,L0=0,Po=1,Kn=12,hs=32;function $0(){const t=as.generateKeyPair();return{privateKey:_t(t.secretKey,yt),publicKey:_t(t.publicKey,yt)}}function Vn(){const t=Fr.randomBytes(hs);return _t(t,yt)}function M0(t,e){const r=as.sharedKey(bt(t,yt),bt(e,yt)),i=new n0(Yi.SHA256,r).expand(hs);return _t(i,yt)}function j0(t){const e=Yi.hash(bt(t,yt));return _t(e,yt)}function Pr(t){const e=Yi.hash(bt(t,ls));return _t(e,yt)}function B0(t){return bt(`${t}`,wc)}function hi(t){return Number(_t(t,wc))}function z0(t){const e=B0(typeof t.type<"u"?t.type:bc);if(hi(e)===Sr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?bt(t.senderPublicKey,yt):void 0,i=typeof t.iv<"u"?bt(t.iv,yt):Fr.randomBytes(Kn),n=new ss.ChaCha20Poly1305(bt(t.symKey,yt)).seal(i,bt(t.message,ls));return K0({type:e,sealed:n,iv:i,senderPublicKey:r})}function q0(t){const e=new ss.ChaCha20Poly1305(bt(t.symKey,yt)),{sealed:r,iv:i}=Ri(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return _t(n,ls)}function K0(t){if(hi(t.type)===Sr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return _t(jn([t.type,t.senderPublicKey,t.iv,t.sealed]),qn)}return _t(jn([t.type,t.iv,t.sealed]),qn)}function Ri(t){const e=bt(t,qn),r=e.slice(L0,Po),i=Po;if(hi(r)===Sr){const a=i+hs,h=a+Kn,l=e.slice(i,a),f=e.slice(a,h),y=e.slice(h);return{type:r,sealed:y,iv:f,senderPublicKey:l}}const n=i+Kn,s=e.slice(i,n),o=e.slice(n);return{type:r,sealed:o,iv:s}}function V0(t,e){const r=Ri(t);return mc({type:hi(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?_t(r.senderPublicKey,yt):void 0,receiverPublicKey:e?.receiverPublicKey})}function mc(t){const e=t?.type||bc;if(e===Sr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ro(t){return t.type===Sr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var H0=Object.defineProperty,No=Object.getOwnPropertySymbols,W0=Object.prototype.hasOwnProperty,k0=Object.prototype.propertyIsEnumerable,Fo=(t,e,r)=>e in t?H0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Uo=(t,e)=>{for(var r in e||(e={}))W0.call(e,r)&&Fo(t,r,e[r]);if(No)for(var r of No(e))k0.call(e,r)&&Fo(t,r,e[r]);return t};const G0="ReactNative",br={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Y0="js";function fs(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function vc(){return!dc()&&!!cs()&&navigator.product===G0}function ds(){return!fs()&&!!cs()}function Ec(){return vc()?br.reactNative:fs()?br.node:ds()?br.browser:br.unknown}function J0(t,e){let r=si.parse(t);return r=Uo(Uo({},r),e),t=si.stringify(r),t}function X0(){return gc()||{name:"",description:"",url:"",icons:[""]}}function Z0(){if(typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=d0();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Q0(){var t;const e=Ec();return e===br.browser?[e,((t=pc())==null?void 0:t.host)||"unknown"].join(":"):e}function eg(t,e,r){const i=Z0(),n=Q0();return[[t,e].join("-"),[Y0,r].join("-"),i,n].join("/")}function tg({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o}){const a=r.split("?"),h=eg(t,e,i),l={auth:n,ua:h,projectId:s,useOnCloseEvent:o||void 0},f=J0(a[1]||"",l);return a[0]+"?"+f}function mr(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Dc(t){return Object.fromEntries(t.entries())}function Sc(t){return new Map(Object.entries(t))}function Tr(t=Q.FIVE_MINUTES,e){const r=Q.toMiliseconds(t||Q.FIVE_MINUTES);let i,n,s;return{resolve:o=>{s&&i&&(clearTimeout(s),i(o))},reject:o=>{s&&n&&(clearTimeout(s),n(o))},done:()=>new Promise((o,a)=>{s=setTimeout(()=>{a(new Error(e))},r),i=o,n=a})}}function Ni(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const o=await t;i(o)}catch(o){n(o)}clearTimeout(s)})}function xc(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function rg(t){return xc("topic",t)}function ig(t){return xc("id",t)}function Ic(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Rt(t,e){return Q.fromMiliseconds((e||Date.now())+Q.toMiliseconds(t))}function er(t){return Date.now()>=Q.toMiliseconds(t)}function Ke(t,e){return`${t}${e?`:${e}`:""}`}async function ng({id:t,topic:e,wcDeepLink:r}){try{if(!r)return;let n=(typeof r=="string"?JSON.parse(r):r)?.href;if(typeof n!="string")return;n.endsWith("/")&&(n=n.slice(0,-1));const s=`${n}/wc?requestId=${t}&sessionTopic=${e}`,o=Ec();o===br.browser?s.startsWith("https://")?window.open(s,"_blank","noreferrer noopener"):window.open(s,"_self","noreferrer noopener"):o===br.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(s)}catch(i){console.error(i)}}const sg="irn";function Hn(t){return t?.relay||{protocol:sg}}function xi(t){const e=U0[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var og=Object.defineProperty,Lo=Object.getOwnPropertySymbols,ag=Object.prototype.hasOwnProperty,cg=Object.prototype.propertyIsEnumerable,$o=(t,e,r)=>e in t?og(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ug=(t,e)=>{for(var r in e||(e={}))ag.call(e,r)&&$o(t,r,e[r]);if(Lo)for(var r of Lo(e))cg.call(e,r)&&$o(t,r,e[r]);return t};function lg(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),o=t[n];r[s]=o}}),r}function hg(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=si.parse(s);return{protocol:i,topic:fg(n[0]),version:parseInt(n[1],10),symKey:o.symKey,relay:lg(o)}}function fg(t){return t.startsWith("//")?t.substring(2):t}function dg(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function pg(t){return`${t.protocol}:${t.topic}@${t.version}?`+si.stringify(ug({symKey:t.symKey},dg(t.relay)))}function Lr(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function gg(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Lr(r.accounts))}),e}function yg(t,e){const r=[];return Object.values(t).forEach(i=>{Lr(i.accounts).includes(e)&&r.push(...i.methods)}),r}function _g(t,e){const r=[];return Object.values(t).forEach(i=>{Lr(i.accounts).includes(e)&&r.push(...i.events)}),r}function wg(t,e){const r=Ii(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return i}const bg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},mg={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function G(t,e){const{message:r,code:i}=mg[t];return{message:e?`${r} ${e}`:r,code:i}}function tt(t,e){const{message:r,code:i}=bg[t];return{message:e?`${r} ${e}`:r,code:i}}function fi(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Qr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function gt(t){return typeof t>"u"}function rt(t,e){return e&&gt(t)?!0:typeof t=="string"&&!!t.trim().length}function ps(t,e){return e&&gt(t)?!0:typeof t=="number"&&!isNaN(t)}function vg(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return mr(n,i)?(i.forEach(o=>{const{accounts:a,methods:h,events:l}=t.namespaces[o],f=Lr(a),y=r[o];(!mr(_c(o,y),f)||!mr(y.methods,h)||!mr(y.events,l))&&(s=!1)}),s):!1}function Fi(t){return rt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Eg(t){if(rt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Fi(r)}}return!1}function Dg(t){if(rt(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Sg(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function xg(t){return t?.topic}function Ig(t,e){let r=null;return rt(t?.publicKey,!1)||(r=G("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Mo(t){let e=!0;return fi(t)?t.length&&(e=t.every(r=>rt(r,!1))):e=!1,e}function Og(t,e,r){let i=null;return fi(e)&&e.length?e.forEach(n=>{i||Fi(n)||(i=tt("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):Fi(t)||(i=tt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function Ag(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const o=Og(n,_c(n,s),`${e} ${r}`);o&&(i=o)}),i}function Tg(t,e){let r=null;return fi(t)?t.forEach(i=>{r||Eg(i)||(r=tt("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=tt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Cg(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Tg(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function Pg(t,e){let r=null;return Mo(t?.methods)?Mo(t?.events)||(r=tt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=tt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Oc(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Pg(i,`${e}, namespace`);n&&(r=n)}),r}function Rg(t,e,r){let i=null;if(t&&Qr(t)){const n=Oc(t,e);n&&(i=n);const s=Ag(t,e,r);s&&(i=s)}else i=G("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Ii(t,e){let r=null;if(t&&Qr(t)){const i=Oc(t,e);i&&(r=i);const n=Cg(t,e);n&&(r=n)}else r=G("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Ac(t){return rt(t.protocol,!0)}function Ng(t,e){let r=!1;return e&&!t?r=!0:t&&fi(t)&&t.length&&t.forEach(i=>{r=Ac(i)}),r}function Fg(t){return typeof t=="number"}function wt(t){return typeof t<"u"&&typeof t!==null}function Ug(t){return!(!t||typeof t!="object"||!t.code||!ps(t.code,!1)||!t.message||!rt(t.message,!1))}function Lg(t){return!(gt(t)||!rt(t.method,!1))}function $g(t){return!(gt(t)||gt(t.result)&&gt(t.error)||!ps(t.id,!1)||!rt(t.jsonrpc,!1))}function Mg(t){return!(gt(t)||!rt(t.name,!1))}function jo(t,e){return!(!Fi(e)||!gg(t).includes(e))}function jg(t,e,r){return rt(r,!1)?yg(t,e).includes(r):!1}function Bg(t,e,r){return rt(r,!1)?_g(t,e).includes(r):!1}function Bo(t,e,r){let i=null;const n=zg(t),s=qg(e),o=Object.keys(n),a=Object.keys(s),h=zo(Object.keys(t)),l=zo(Object.keys(e)),f=h.filter(y=>!l.includes(y));return f.length&&(i=G("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(e).toString()}`)),mr(o,a)||(i=G("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(y=>{if(!y.includes(":")||i)return;const _=Lr(e[y].accounts);_.includes(y)||(i=G("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${y}
        Required: ${y}
        Approved: ${_.toString()}`))}),o.forEach(y=>{i||(mr(n[y].methods,s[y].methods)?mr(n[y].events,s[y].events)||(i=G("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${y}`)):i=G("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${y}`))}),i}function zg(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function zo(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function qg(t){const e={};return Object.keys(t).forEach(r=>{r.includes(":")?e[r]=t[r]:Lr(t[r].accounts)?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}),e}function Kg(t,e){return ps(t,!1)&&t<=e.max&&t>=e.min}const Vg="PARSE_ERROR",Hg="INVALID_REQUEST",Wg="METHOD_NOT_FOUND",kg="INVALID_PARAMS",Tc="INTERNAL_ERROR",gs="SERVER_ERROR",Gg=[-32700,-32600,-32601,-32602,-32603],ei={[Vg]:{code:-32700,message:"Parse error"},[Hg]:{code:-32600,message:"Invalid Request"},[Wg]:{code:-32601,message:"Method not found"},[kg]:{code:-32602,message:"Invalid params"},[Tc]:{code:-32603,message:"Internal error"},[gs]:{code:-32e3,message:"Server error"}},Cc=gs;function Yg(t){return Gg.includes(t)}function qo(t){return Object.keys(ei).includes(t)?ei[t]:ei[Cc]}function Jg(t){const e=Object.values(ei).find(r=>r.code===t);return e||ei[Cc]}function Xg(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Pc={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wn=function(t,e){return Wn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Wn(t,e)};function Zg(t,e){Wn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var kn=function(){return kn=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},kn.apply(this,arguments)};function Qg(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ey(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function ty(t,e){return function(r,i){e(r,i,t)}}function ry(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function iy(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(f){try{l(i.next(f))}catch(y){o(y)}}function h(f){try{l(i.throw(f))}catch(y){o(y)}}function l(f){f.done?s(f.value):n(f.value).then(a,h)}l((i=i.apply(t,e||[])).next())})}function ny(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(f){return h([l,f])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function sy(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function oy(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Gn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rc(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function ay(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Rc(arguments[e]));return t}function cy(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function oi(t){return this instanceof oi?(this.v=t,this):new oi(t)}function uy(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(_){i[_]&&(n[_]=function(b){return new Promise(function(E,C){s.push([_,b,E,C])>1||a(_,b)})})}function a(_,b){try{h(i[_](b))}catch(E){y(s[0][3],E)}}function h(_){_.value instanceof oi?Promise.resolve(_.value.v).then(l,f):y(s[0][2],_)}function l(_){a("next",_)}function f(_){a("throw",_)}function y(_,b){_(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ly(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:oi(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function hy(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Gn=="function"?Gn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),n(a,h,o.done,o.value)})}}function n(s,o,a,h){Promise.resolve(h).then(function(l){s({value:l,done:a})},o)}}function fy(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function dy(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function py(t){return t&&t.__esModule?t:{default:t}}function gy(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function yy(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var _y=Object.freeze({__proto__:null,get __assign(){return kn},__asyncDelegator:ly,__asyncGenerator:uy,__asyncValues:hy,__await:oi,__awaiter:iy,__classPrivateFieldGet:gy,__classPrivateFieldSet:yy,__createBinding:sy,__decorate:ey,__exportStar:oy,__extends:Zg,__generator:ny,__importDefault:py,__importStar:dy,__makeTemplateObject:fy,__metadata:ry,__param:ty,__read:Rc,__rest:Qg,__spread:ay,__spreadArrays:cy,__values:Gn}),wy=nr(_y),Ht={},Ko;function by(){if(Ko)return Ht;Ko=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.isBrowserCryptoAvailable=Ht.getSubtleCrypto=Ht.getBrowerCrypto=void 0;function t(){return Dt?.crypto||Dt?.msCrypto||{}}Ht.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Ht.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Ht.isBrowserCryptoAvailable=r,Ht}var Wt={},Vo;function my(){if(Vo)return Wt;Vo=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.isBrowser=Wt.isNode=Wt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Wt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Wt.isNode=e;function r(){return!t()&&!e()}return Wt.isBrowser=r,Wt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=wy;e.__exportStar(by(),t),e.__exportStar(my(),t)})(Pc);function Nc(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function ys(t=6){return BigInt(Nc(t))}function Ji(t,e,r){return{id:r||Nc(),jsonrpc:"2.0",method:t,params:e}}function _s(t,e){return{id:t,jsonrpc:"2.0",result:e}}function ws(t,e,r){return{id:t,jsonrpc:"2.0",error:vy(e,r)}}function vy(t,e){return typeof t>"u"?qo(Tc):(typeof t=="string"&&(t=Object.assign(Object.assign({},qo(gs)),{message:t})),typeof e<"u"&&(t.data=e),Yg(t.code)&&(t=Jg(t.code)),t)}class Ey{}class Dy extends Ey{constructor(){super()}}class Sy extends Dy{constructor(e){super()}}const xy="^wss?:";function Iy(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Oy(t,e){const r=Iy(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Ho(t){return Oy(t,xy)}function Ay(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Fc(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function bs(t){return Fc(t)&&"method"in t}function Xi(t){return Fc(t)&&(kt(t)||Nt(t))}function kt(t){return"result"in t}function Nt(t){return"error"in t}class Ty extends Sy{constructor(e){super(e),this.events=new ce,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Ji(e.method,e.params||[],e.id||ys().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Nt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Xi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Wo=10,Cy=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Py=()=>typeof window<"u",Ry=Cy();class Ny{constructor(e){if(this.url=e,this.events=new ce,this.registering=!1,!Ho(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(rs(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Ho(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Pc.isReactNative()?void 0:{rejectUnauthorized:!Ay(e)},s=new Ry(e,[],n);Py()?s.onerror=o=>{const a=o;i(this.emitError(a.error))}:s.on("error",o=>{i(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Wa(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=ws(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Xg(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Wo&&this.events.setMaxListeners(Wo)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ui={exports:{}};Ui.exports;(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,a="[object Arguments]",h="[object Array]",l="[object AsyncFunction]",f="[object Boolean]",y="[object Date]",_="[object Error]",b="[object Function]",E="[object GeneratorFunction]",C="[object Map]",F="[object Number]",z="[object Null]",D="[object Object]",O="[object Promise]",w="[object Proxy]",v="[object RegExp]",p="[object Set]",c="[object String]",d="[object Symbol]",N="[object Undefined]",R="[object WeakMap]",U="[object ArrayBuffer]",V="[object DataView]",Y="[object Float32Array]",S="[object Float64Array]",P="[object Int8Array]",k="[object Int16Array]",q="[object Int32Array]",$="[object Uint8Array]",B="[object Uint8ClampedArray]",L="[object Uint16Array]",K="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,H=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,X={};X[Y]=X[S]=X[P]=X[k]=X[q]=X[$]=X[B]=X[L]=X[K]=!0,X[a]=X[h]=X[U]=X[f]=X[V]=X[y]=X[_]=X[b]=X[C]=X[F]=X[D]=X[v]=X[p]=X[c]=X[R]=!1;var te=typeof Dt=="object"&&Dt&&Dt.Object===Object&&Dt,T=typeof self=="object"&&self&&self.Object===Object&&self,A=te||T||Function("return this")(),x=e&&!e.nodeType&&e,u=x&&!0&&t&&!t.nodeType&&t,m=u&&u.exports===x,W=m&&te.process,J=function(){try{return W&&W.binding&&W.binding("util")}catch{}}(),de=J&&J.isTypedArray;function be(g,I){for(var M=-1,Z=g==null?0:g.length,Ae=0,oe=[];++M<Z;){var Ue=g[M];I(Ue,M,g)&&(oe[Ae++]=Ue)}return oe}function ge(g,I){for(var M=-1,Z=I.length,Ae=g.length;++M<Z;)g[Ae+M]=I[M];return g}function De(g,I){for(var M=-1,Z=g==null?0:g.length;++M<Z;)if(I(g[M],M,g))return!0;return!1}function $e(g,I){for(var M=-1,Z=Array(g);++M<g;)Z[M]=I(M);return Z}function Re(g){return function(I){return g(I)}}function we(g,I){return g.has(I)}function ye(g,I){return g?.[I]}function pe(g){var I=-1,M=Array(g.size);return g.forEach(function(Z,Ae){M[++I]=[Ae,Z]}),M}function he(g,I){return function(M){return g(I(M))}}function le(g){var I=-1,M=Array(g.size);return g.forEach(function(Z){M[++I]=Z}),M}var ue=Array.prototype,ae=Function.prototype,ie=Object.prototype,fe=A["__core-js_shared__"],_e=ae.toString,ne=ie.hasOwnProperty,me=function(){var g=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Ee=ie.toString,xe=RegExp("^"+_e.call(ne).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ie=m?A.Buffer:void 0,Se=A.Symbol,Ct=A.Uint8Array,Ut=ie.propertyIsEnumerable,Yt=ue.splice,vt=Se?Se.toStringTag:void 0,or=Object.getOwnPropertySymbols,$r=Ie?Ie.isBuffer:void 0,pi=he(Object.keys,Object),Me=xr(A,"DataView"),Ne=xr(A,"Map"),je=xr(A,"Promise"),Be=xr(A,"Set"),ze=xr(A,"WeakMap"),Fe=xr(Object,"create"),He=cr(Me),We=cr(Ne),ke=cr(je),Ge=cr(Be),Ye=cr(ze),Ve=Se?Se.prototype:void 0,qe=Ve?Ve.valueOf:void 0;function Te(g){var I=-1,M=g==null?0:g.length;for(this.clear();++I<M;){var Z=g[I];this.set(Z[0],Z[1])}}function Je(){this.__data__=Fe?Fe(null):{},this.size=0}function Xe(g){var I=this.has(g)&&delete this.__data__[g];return this.size-=I?1:0,I}function Qc(g){var I=this.__data__;if(Fe){var M=I[g];return M===i?void 0:M}return ne.call(I,g)?I[g]:void 0}function eu(g){var I=this.__data__;return Fe?I[g]!==void 0:ne.call(I,g)}function tu(g,I){var M=this.__data__;return this.size+=this.has(g)?0:1,M[g]=Fe&&I===void 0?i:I,this}Te.prototype.clear=Je,Te.prototype.delete=Xe,Te.prototype.get=Qc,Te.prototype.has=eu,Te.prototype.set=tu;function Kt(g){var I=-1,M=g==null?0:g.length;for(this.clear();++I<M;){var Z=g[I];this.set(Z[0],Z[1])}}function ru(){this.__data__=[],this.size=0}function iu(g){var I=this.__data__,M=yi(I,g);if(M<0)return!1;var Z=I.length-1;return M==Z?I.pop():Yt.call(I,M,1),--this.size,!0}function nu(g){var I=this.__data__,M=yi(I,g);return M<0?void 0:I[M][1]}function su(g){return yi(this.__data__,g)>-1}function ou(g,I){var M=this.__data__,Z=yi(M,g);return Z<0?(++this.size,M.push([g,I])):M[Z][1]=I,this}Kt.prototype.clear=ru,Kt.prototype.delete=iu,Kt.prototype.get=nu,Kt.prototype.has=su,Kt.prototype.set=ou;function ar(g){var I=-1,M=g==null?0:g.length;for(this.clear();++I<M;){var Z=g[I];this.set(Z[0],Z[1])}}function au(){this.size=0,this.__data__={hash:new Te,map:new(Ne||Kt),string:new Te}}function cu(g){var I=_i(this,g).delete(g);return this.size-=I?1:0,I}function uu(g){return _i(this,g).get(g)}function lu(g){return _i(this,g).has(g)}function hu(g,I){var M=_i(this,g),Z=M.size;return M.set(g,I),this.size+=M.size==Z?0:1,this}ar.prototype.clear=au,ar.prototype.delete=cu,ar.prototype.get=uu,ar.prototype.has=lu,ar.prototype.set=hu;function gi(g){var I=-1,M=g==null?0:g.length;for(this.__data__=new ar;++I<M;)this.add(g[I])}function fu(g){return this.__data__.set(g,i),this}function du(g){return this.__data__.has(g)}gi.prototype.add=gi.prototype.push=fu,gi.prototype.has=du;function Jt(g){var I=this.__data__=new Kt(g);this.size=I.size}function pu(){this.__data__=new Kt,this.size=0}function gu(g){var I=this.__data__,M=I.delete(g);return this.size=I.size,M}function yu(g){return this.__data__.get(g)}function _u(g){return this.__data__.has(g)}function wu(g,I){var M=this.__data__;if(M instanceof Kt){var Z=M.__data__;if(!Ne||Z.length<r-1)return Z.push([g,I]),this.size=++M.size,this;M=this.__data__=new ar(Z)}return M.set(g,I),this.size=M.size,this}Jt.prototype.clear=pu,Jt.prototype.delete=gu,Jt.prototype.get=yu,Jt.prototype.has=_u,Jt.prototype.set=wu;function bu(g,I){var M=wi(g),Z=!M&&Fu(g),Ae=!M&&!Z&&en(g),oe=!M&&!Z&&!Ae&&Ns(g),Ue=M||Z||Ae||oe,Ze=Ue?$e(g.length,String):[],nt=Ze.length;for(var Pe in g)(I||ne.call(g,Pe))&&!(Ue&&(Pe=="length"||Ae&&(Pe=="offset"||Pe=="parent")||oe&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||Tu(Pe,nt)))&&Ze.push(Pe);return Ze}function yi(g,I){for(var M=g.length;M--;)if(Ts(g[M][0],I))return M;return-1}function mu(g,I,M){var Z=I(g);return wi(g)?Z:ge(Z,M(g))}function Mr(g){return g==null?g===void 0?N:z:vt&&vt in Object(g)?Ou(g):Nu(g)}function xs(g){return jr(g)&&Mr(g)==a}function Is(g,I,M,Z,Ae){return g===I?!0:g==null||I==null||!jr(g)&&!jr(I)?g!==g&&I!==I:vu(g,I,M,Z,Is,Ae)}function vu(g,I,M,Z,Ae,oe){var Ue=wi(g),Ze=wi(I),nt=Ue?h:Xt(g),Pe=Ze?h:Xt(I);nt=nt==a?D:nt,Pe=Pe==a?D:Pe;var Et=nt==D,Pt=Pe==D,at=nt==Pe;if(at&&en(g)){if(!en(I))return!1;Ue=!0,Et=!1}if(at&&!Et)return oe||(oe=new Jt),Ue||Ns(g)?Os(g,I,M,Z,Ae,oe):xu(g,I,nt,M,Z,Ae,oe);if(!(M&n)){var xt=Et&&ne.call(g,"__wrapped__"),It=Pt&&ne.call(I,"__wrapped__");if(xt||It){var Zt=xt?g.value():g,Vt=It?I.value():I;return oe||(oe=new Jt),Ae(Zt,Vt,M,Z,oe)}}return at?(oe||(oe=new Jt),Iu(g,I,M,Z,Ae,oe)):!1}function Eu(g){if(!Rs(g)||Pu(g))return!1;var I=Cs(g)?xe:H;return I.test(cr(g))}function Du(g){return jr(g)&&Ps(g.length)&&!!X[Mr(g)]}function Su(g){if(!Ru(g))return pi(g);var I=[];for(var M in Object(g))ne.call(g,M)&&M!="constructor"&&I.push(M);return I}function Os(g,I,M,Z,Ae,oe){var Ue=M&n,Ze=g.length,nt=I.length;if(Ze!=nt&&!(Ue&&nt>Ze))return!1;var Pe=oe.get(g);if(Pe&&oe.get(I))return Pe==I;var Et=-1,Pt=!0,at=M&s?new gi:void 0;for(oe.set(g,I),oe.set(I,g);++Et<Ze;){var xt=g[Et],It=I[Et];if(Z)var Zt=Ue?Z(It,xt,Et,I,g,oe):Z(xt,It,Et,g,I,oe);if(Zt!==void 0){if(Zt)continue;Pt=!1;break}if(at){if(!De(I,function(Vt,ur){if(!we(at,ur)&&(xt===Vt||Ae(xt,Vt,M,Z,oe)))return at.push(ur)})){Pt=!1;break}}else if(!(xt===It||Ae(xt,It,M,Z,oe))){Pt=!1;break}}return oe.delete(g),oe.delete(I),Pt}function xu(g,I,M,Z,Ae,oe,Ue){switch(M){case V:if(g.byteLength!=I.byteLength||g.byteOffset!=I.byteOffset)return!1;g=g.buffer,I=I.buffer;case U:return!(g.byteLength!=I.byteLength||!oe(new Ct(g),new Ct(I)));case f:case y:case F:return Ts(+g,+I);case _:return g.name==I.name&&g.message==I.message;case v:case c:return g==I+"";case C:var Ze=pe;case p:var nt=Z&n;if(Ze||(Ze=le),g.size!=I.size&&!nt)return!1;var Pe=Ue.get(g);if(Pe)return Pe==I;Z|=s,Ue.set(g,I);var Et=Os(Ze(g),Ze(I),Z,Ae,oe,Ue);return Ue.delete(g),Et;case d:if(qe)return qe.call(g)==qe.call(I)}return!1}function Iu(g,I,M,Z,Ae,oe){var Ue=M&n,Ze=As(g),nt=Ze.length,Pe=As(I),Et=Pe.length;if(nt!=Et&&!Ue)return!1;for(var Pt=nt;Pt--;){var at=Ze[Pt];if(!(Ue?at in I:ne.call(I,at)))return!1}var xt=oe.get(g);if(xt&&oe.get(I))return xt==I;var It=!0;oe.set(g,I),oe.set(I,g);for(var Zt=Ue;++Pt<nt;){at=Ze[Pt];var Vt=g[at],ur=I[at];if(Z)var Fs=Ue?Z(ur,Vt,at,I,g,oe):Z(Vt,ur,at,g,I,oe);if(!(Fs===void 0?Vt===ur||Ae(Vt,ur,M,Z,oe):Fs)){It=!1;break}Zt||(Zt=at=="constructor")}if(It&&!Zt){var bi=g.constructor,mi=I.constructor;bi!=mi&&"constructor"in g&&"constructor"in I&&!(typeof bi=="function"&&bi instanceof bi&&typeof mi=="function"&&mi instanceof mi)&&(It=!1)}return oe.delete(g),oe.delete(I),It}function As(g){return mu(g,$u,Au)}function _i(g,I){var M=g.__data__;return Cu(I)?M[typeof I=="string"?"string":"hash"]:M.map}function xr(g,I){var M=ye(g,I);return Eu(M)?M:void 0}function Ou(g){var I=ne.call(g,vt),M=g[vt];try{g[vt]=void 0;var Z=!0}catch{}var Ae=Ee.call(g);return Z&&(I?g[vt]=M:delete g[vt]),Ae}var Au=or?function(g){return g==null?[]:(g=Object(g),be(or(g),function(I){return Ut.call(g,I)}))}:Mu,Xt=Mr;(Me&&Xt(new Me(new ArrayBuffer(1)))!=V||Ne&&Xt(new Ne)!=C||je&&Xt(je.resolve())!=O||Be&&Xt(new Be)!=p||ze&&Xt(new ze)!=R)&&(Xt=function(g){var I=Mr(g),M=I==D?g.constructor:void 0,Z=M?cr(M):"";if(Z)switch(Z){case He:return V;case We:return C;case ke:return O;case Ge:return p;case Ye:return R}return I});function Tu(g,I){return I=I??o,!!I&&(typeof g=="number"||ee.test(g))&&g>-1&&g%1==0&&g<I}function Cu(g){var I=typeof g;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?g!=="__proto__":g===null}function Pu(g){return!!me&&me in g}function Ru(g){var I=g&&g.constructor,M=typeof I=="function"&&I.prototype||ie;return g===M}function Nu(g){return Ee.call(g)}function cr(g){if(g!=null){try{return _e.call(g)}catch{}try{return g+""}catch{}}return""}function Ts(g,I){return g===I||g!==g&&I!==I}var Fu=xs(function(){return arguments}())?xs:function(g){return jr(g)&&ne.call(g,"callee")&&!Ut.call(g,"callee")},wi=Array.isArray;function Uu(g){return g!=null&&Ps(g.length)&&!Cs(g)}var en=$r||ju;function Lu(g,I){return Is(g,I)}function Cs(g){if(!Rs(g))return!1;var I=Mr(g);return I==b||I==E||I==l||I==w}function Ps(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=o}function Rs(g){var I=typeof g;return g!=null&&(I=="object"||I=="function")}function jr(g){return g!=null&&typeof g=="object"}var Ns=de?Re(de):Du;function $u(g){return Uu(g)?bu(g):Su(g)}function Mu(){return[]}function ju(){return!1}t.exports=Lu})(Ui,Ui.exports);var Fy=Ui.exports,Uy=Hl(Fy);function Ly(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,h=t.charAt(0),l=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function y(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var C=0,F=0,z=0,D=E.length;z!==D&&E[z]===0;)z++,C++;for(var O=(D-z)*f+1>>>0,w=new Uint8Array(O);z!==D;){for(var v=E[z],p=0,c=O-1;(v!==0||p<F)&&c!==-1;c--,p++)v+=256*w[c]>>>0,w[c]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");F=p,z++}for(var d=O-F;d!==O&&w[d]===0;)d++;for(var N=h.repeat(C);d<O;++d)N+=t.charAt(w[d]);return N}function _(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var C=0;if(E[C]!==" "){for(var F=0,z=0;E[C]===h;)F++,C++;for(var D=(E.length-C)*l+1>>>0,O=new Uint8Array(D);E[C];){var w=r[E.charCodeAt(C)];if(w===255)return;for(var v=0,p=D-1;(w!==0||v<z)&&p!==-1;p--,v++)w+=a*O[p]>>>0,O[p]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");z=v,C++}if(E[C]!==" "){for(var c=D-z;c!==D&&O[c]===0;)c++;for(var d=new Uint8Array(F+(D-c)),N=F;c!==D;)d[N++]=O[c++];return d}}}function b(E){var C=_(E);if(C)return C;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:_,decode:b}}var $y=Ly,My=$y;const Uc=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},jy=t=>new TextEncoder().encode(t),By=t=>new TextDecoder().decode(t);class zy{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class qy{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Lc(this,e)}}class Ky{constructor(e){this.decoders=e}or(e){return Lc(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Lc=(t,e)=>new Ky({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Vy{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new zy(e,r,i),this.decoder=new qy(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Zi=({name:t,prefix:e,encode:r,decode:i})=>new Vy(t,e,r,i),di=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=My(r,e);return Zi({prefix:t,name:e,encode:i,decode:s=>Uc(n(s))})},Hy=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,l=0;for(let f=0;f<s;++f){const y=n[t[f]];if(y===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|y,a+=r,a>=8&&(a-=8,o[l++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},Wy=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},ot=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Zi({prefix:e,name:t,encode(n){return Wy(n,i,r)},decode(n){return Hy(n,i,r,t)}}),ky=Zi({prefix:"\0",name:"identity",encode:t=>By(t),decode:t=>jy(t)});var Gy=Object.freeze({__proto__:null,identity:ky});const Yy=ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Jy=Object.freeze({__proto__:null,base2:Yy});const Xy=ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Zy=Object.freeze({__proto__:null,base8:Xy});const Qy=di({prefix:"9",name:"base10",alphabet:"0123456789"});var e1=Object.freeze({__proto__:null,base10:Qy});const t1=ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),r1=ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var i1=Object.freeze({__proto__:null,base16:t1,base16upper:r1});const n1=ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s1=ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o1=ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a1=ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c1=ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),u1=ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l1=ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h1=ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),f1=ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var d1=Object.freeze({__proto__:null,base32:n1,base32upper:s1,base32pad:o1,base32padupper:a1,base32hex:c1,base32hexupper:u1,base32hexpad:l1,base32hexpadupper:h1,base32z:f1});const p1=di({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),g1=di({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var y1=Object.freeze({__proto__:null,base36:p1,base36upper:g1});const _1=di({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),w1=di({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var b1=Object.freeze({__proto__:null,base58btc:_1,base58flickr:w1});const m1=ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),v1=ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),E1=ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),D1=ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var S1=Object.freeze({__proto__:null,base64:m1,base64pad:v1,base64url:E1,base64urlpad:D1});const $c=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),x1=$c.reduce((t,e,r)=>(t[r]=e,t),[]),I1=$c.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function O1(t){return t.reduce((e,r)=>(e+=x1[r],e),"")}function A1(t){const e=[];for(const r of t){const i=I1[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const T1=Zi({prefix:"\u{1F680}",name:"base256emoji",encode:O1,decode:A1});var C1=Object.freeze({__proto__:null,base256emoji:T1}),P1=Mc,ko=128,R1=127,N1=~R1,F1=Math.pow(2,31);function Mc(t,e,r){e=e||[],r=r||0;for(var i=r;t>=F1;)e[r++]=t&255|ko,t/=128;for(;t&N1;)e[r++]=t&255|ko,t>>>=7;return e[r]=t|0,Mc.bytes=r-i+1,e}var U1=Yn,L1=128,Go=127;function Yn(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw Yn.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&Go)<<n:(o&Go)*Math.pow(2,n),n+=7}while(o>=L1);return Yn.bytes=s-i,r}var $1=Math.pow(2,7),M1=Math.pow(2,14),j1=Math.pow(2,21),B1=Math.pow(2,28),z1=Math.pow(2,35),q1=Math.pow(2,42),K1=Math.pow(2,49),V1=Math.pow(2,56),H1=Math.pow(2,63),W1=function(t){return t<$1?1:t<M1?2:t<j1?3:t<B1?4:t<z1?5:t<q1?6:t<K1?7:t<V1?8:t<H1?9:10},k1={encode:P1,decode:U1,encodingLength:W1},jc=k1;const Yo=(t,e,r=0)=>(jc.encode(t,e,r),e),Jo=t=>jc.encodingLength(t),Jn=(t,e)=>{const r=e.byteLength,i=Jo(t),n=i+Jo(r),s=new Uint8Array(n+r);return Yo(t,s,0),Yo(r,s,i),s.set(e,n),new G1(t,r,e,s)};class G1{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Bc=({name:t,code:e,encode:r})=>new Y1(t,e,r);class Y1{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Jn(this.code,r):r.then(i=>Jn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const zc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),J1=Bc({name:"sha2-256",code:18,encode:zc("SHA-256")}),X1=Bc({name:"sha2-512",code:19,encode:zc("SHA-512")});var Z1=Object.freeze({__proto__:null,sha256:J1,sha512:X1});const qc=0,Q1="identity",Kc=Uc,e_=t=>Jn(qc,Kc(t)),t_={code:qc,name:Q1,encode:Kc,digest:e_};var r_=Object.freeze({__proto__:null,identity:t_});new TextEncoder,new TextDecoder;const Xo={...Gy,...Jy,...Zy,...e1,...i1,...d1,...y1,...b1,...S1,...C1};({...Z1,...r_});function Vc(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function i_(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Vc(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Hc(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Zo=Hc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),pn=Hc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=i_(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),n_={utf8:Zo,"utf-8":Zo,hex:Xo.base16,latin1:pn,ascii:pn,binary:pn,...Xo};function s_(t,e="utf8"){const r=n_[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Vc(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}const Wc="wc",o_=2,ms="core",rr=`${Wc}@2:${ms}:`,a_={name:ms,logger:"error"},c_={database:":memory:"},u_="crypto",Qo="client_ed25519_seed",l_=Q.ONE_DAY,h_="keychain",f_="0.3",d_="messages",p_="0.3",g_=Q.SIX_HOURS,y_="publisher",kc="irn",__="error",Gc="wss://relay.walletconnect.com",ea="wss://relay.walletconnect.org",w_="relayer",Le={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},b_="_subscription",Gr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},m_=Q.ONE_SECOND/2,v_="2.8.6",E_=1e4,D_="0.3",S_="WALLETCONNECT_CLIENT_ID",Bt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},x_="subscription",I_="0.3",O_=Q.FIVE_SECONDS*1e3,A_="pairing",T_="0.3",Yr={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},jt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},C_="history",P_="0.3",R_="expirer",At={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},N_="0.3",gn="verify-api",ta="https://verify.walletconnect.com";class F_{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=h_,this.version=f_,this.initialized=!1,this.storagePrefix=rr,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=G("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=ve.generateChildLogger(r,this.name)}get context(){return ve.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Dc(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Sc(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}class U_{constructor(e,r,i){this.core=e,this.logger=r,this.name=u_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=vo(n);return ac(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=$0();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),o=vo(s),a=Vn();return await Hp(a,n,l_,o)},this.generateSharedKey=(n,s,o)=>{this.isInitialized();const a=this.getPrivateKey(n),h=M0(a,s);return this.setSymKey(h,o)},this.setSymKey=async(n,s)=>{this.isInitialized();const o=s||j0(n);return await this.keychain.set(o,n),o},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,o)=>{this.isInitialized();const a=mc(o),h=rs(s);if(Ro(a)){const _=a.senderPublicKey,b=a.receiverPublicKey;n=await this.generateSharedKey(_,b)}const l=this.getSymKey(n),{type:f,senderPublicKey:y}=a;return z0({type:f,symKey:l,message:h,senderPublicKey:y})},this.decode=async(n,s,o)=>{this.isInitialized();const a=V0(s,o);if(Ro(a)){const f=a.receiverPublicKey,y=a.senderPublicKey;n=await this.generateSharedKey(f,y)}const h=this.getSymKey(n),l=q0({symKey:h,encoded:s});return Wa(l)},this.getPayloadType=n=>{const s=Ri(n);return hi(s.type)},this.getPayloadSenderPublicKey=n=>{const s=Ri(n);return s.senderPublicKey?_t(s.senderPublicKey,yt):void 0},this.core=e,this.logger=ve.generateChildLogger(r,this.name),this.keychain=i||new F_(this.core,this.logger)}get context(){return ve.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Qo)}catch{e=Vn(),await this.keychain.set(Qo,e)}return s_(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}class L_ extends Gf{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=d_,this.version=p_,this.initialized=!1,this.storagePrefix=rr,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=Pr(n);let o=this.messages.get(i);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=n,this.messages.set(i,o),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),o=Pr(n);return typeof s[o]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=ve.generateChildLogger(e,this.name),this.core=r}get context(){return ve.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Dc(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Sc(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}class $_ extends Yf{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ce,this.name=y_,this.queue=new Map,this.publishTimeout=Q.toMiliseconds(Q.TEN_SECONDS),this.queueTimeout=Q.toMiliseconds(Q.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const o=s?.ttl||g_,a=Hn(s),h=s?.prompt||!1,l=s?.tag||0,f=s?.id||ys().toString(),y={topic:i,message:n,opts:{ttl:o,relay:a,prompt:h,tag:l,id:f}},_=setTimeout(()=>this.queue.set(f,y),this.queueTimeout);try{await await Ni(this.rpcPublish(i,n,o,a,h,l,f),this.publishTimeout),clearTimeout(_),this.relayer.events.emit(Le.publish,y)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=ve.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return ve.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,o,a){var h,l,f,y;const _={method:xi(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:o},id:a};return gt((h=_.params)==null?void 0:h.prompt)&&((l=_.params)==null||delete l.prompt),gt((f=_.params)==null?void 0:f.tag)&&((y=_.params)==null||delete y.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:_}),this.relayer.request(_)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Le.connection_stalled);return}this.checkQueue()}),this.relayer.on(Le.message_ack,e=>{this.onPublish(e.id.toString())})}}class M_{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var j_=Object.defineProperty,B_=Object.defineProperties,z_=Object.getOwnPropertyDescriptors,ra=Object.getOwnPropertySymbols,q_=Object.prototype.hasOwnProperty,K_=Object.prototype.propertyIsEnumerable,ia=(t,e,r)=>e in t?j_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jr=(t,e)=>{for(var r in e||(e={}))q_.call(e,r)&&ia(t,r,e[r]);if(ra)for(var r of ra(e))K_.call(e,r)&&ia(t,r,e[r]);return t},yn=(t,e)=>B_(t,z_(e));class V_ extends Zf{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new M_,this.events=new ce,this.name=x_,this.version=I_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=rr,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=Hn(n),o={topic:i,relay:s};this.pending.set(i,o);const a=await this.rpcSubscribe(i,s);return this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const o=new Q.Watch;o.start(this.pendingSubscriptionWatchLabel);const a=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),n(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=O_&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=ve.generateChildLogger(r,this.name),this.clientId=""}get context(){return ve.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=Hn(i);await this.rpcUnsubscribe(e,r,n);const s=tt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:xi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Ni(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Le.connection_stalled)}return Pr(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:xi(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await Ni(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Le.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:xi(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,yn(Jr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Jr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Jr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Bt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Bt.deleted,yn(Jr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Bt.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Bt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);fi(r)&&this.onBatchSubscribe(r.map((i,n)=>yn(Jr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Le.connect,async()=>{await this.onConnect()}),this.relayer.on(Le.disconnect,()=>{this.onDisconnect()}),this.events.on(Bt.created,async e=>{const r=Bt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Bt.deleted,async e=>{const r=Bt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var H_=Object.defineProperty,na=Object.getOwnPropertySymbols,W_=Object.prototype.hasOwnProperty,k_=Object.prototype.propertyIsEnumerable,sa=(t,e,r)=>e in t?H_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,G_=(t,e)=>{for(var r in e||(e={}))W_.call(e,r)&&sa(t,r,e[r]);if(na)for(var r of na(e))k_.call(e,r)&&sa(t,r,e[r]);return t};class Y_ extends Jf{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ce,this.name=w_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?ve.generateChildLogger(e.logger,this.name):ve.pino(ve.getDefaultLoggerOptions({level:e.logger||__})),this.messages=new L_(this.logger,e.core),this.subscriber=new V_(this,this.logger),this.publisher=new $_(this,this.logger),this.relayUrl=e?.relayUrl||Gc,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ea}...`),await this.restartTransport(ea)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},E_)}get context(){return ve.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var i;this.isInitialized();let n=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"";return n||(await Promise.all([new Promise(s=>{this.subscriber.once(Bt.created,o=>{o.topic===e&&s()})}),new Promise(async s=>{n=await this.subscriber.subscribe(e,r),s()})]),n)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Le.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Bt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,i)=>{await Ni(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(n=>i(n)).then(()=>r()).finally(()=>this.removeListener(Le.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Le.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.events.emit(Le.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(Gr.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ty(new Ny(tg({sdkVersion:v_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),bs(e)){if(!e.method.endsWith(b_))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,o={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(G_({type:"event",event:r.id},o)),this.events.emit(r.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else Xi(e)&&this.events.emit(Le.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Le.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=_s(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Gr.payload,e=>this.onProviderPayload(e)),this.provider.on(Gr.connect,()=>{this.events.emit(Le.connect)}),this.provider.on(Gr.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Gr.error,e=>{this.logger.error(e),this.events.emit(Le.error,e)})}registerEventListeners(){this.events.on(Le.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Le.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Q.toMiliseconds(m_))}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var J_=Object.defineProperty,oa=Object.getOwnPropertySymbols,X_=Object.prototype.hasOwnProperty,Z_=Object.prototype.propertyIsEnumerable,aa=(t,e,r)=>e in t?J_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ca=(t,e)=>{for(var r in e||(e={}))X_.call(e,r)&&aa(t,r,e[r]);if(oa)for(var r of oa(e))Z_.call(e,r)&&aa(t,r,e[r]);return t};class Qi extends Xf{constructor(e,r,i,n=rr,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=D_,this.cached=[],this.initialized=!1,this.storagePrefix=rr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!gt(o)?this.map.set(this.getKey(o),o):Sg(o)?this.map.set(o.id,o):xg(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)},this.set=async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(h=>Uy(a[h],o[h]))):this.values),this.update=async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const h=ca(ca({},this.getData(o)),a);this.map.set(o,h),await this.persist()},this.delete=async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),await this.persist())},this.logger=ve.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return ve.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Q_{constructor(e,r){this.core=e,this.logger=r,this.name=A_,this.version=T_,this.events=new ce,this.initialized=!1,this.storagePrefix=rr,this.ignoredPayloadTypes=[Sr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Vn(),n=await this.core.crypto.setSymKey(i),s=Rt(Q.FIVE_MINUTES),o={protocol:kc},a={topic:n,expiry:s,relay:o,active:!1},h=pg({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:o});return await this.pairings.set(n,a),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:h}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:o}=hg(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const a=Rt(Q.FIVE_MINUTES),h={topic:n,relay:o,expiry:a,active:!1};return await this.pairings.set(n,h),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:o}),this.core.expirer.set(n,a),i.activatePairing&&await this.activate({topic:n}),h},this.activate=async({topic:i})=>{this.isInitialized();const n=Rt(Q.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:a,reject:h}=Tr();this.events.once(Ke("pairing_ping",s),({error:l})=>{l?h(l):a()}),await o()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",tt("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const o=Ji(n,s),a=await this.core.crypto.encode(i,o),h=Yr[n].req;return this.core.history.set(i,o),this.core.relayer.publish(i,a,h),o.id},this.sendResult=async(i,n,s)=>{const o=_s(i,s),a=await this.core.crypto.encode(n,o),h=await this.core.history.get(n,i),l=Yr[h.request.method].res;await this.core.relayer.publish(n,a,l),await this.core.history.resolve(o)},this.sendError=async(i,n,s)=>{const o=ws(i,s),a=await this.core.crypto.encode(n,o),h=await this.core.history.get(n,i),l=Yr[h.request.method]?Yr[h.request.method].res:Yr.unregistered_method.res;await this.core.relayer.publish(n,a,l),await this.core.history.resolve(o)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,tt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>er(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i,o=s.method;if(this.pairings.keys.includes(n))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,o=(await this.core.history.get(n,s.id)).request.method;if(this.pairings.keys.includes(n))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{kt(n)?this.events.emit(Ke("pairing_ping",s),{}):Nt(n)&&this.events.emit(Ke("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:o}=n;try{if(this.registeredMethods.includes(o))return;const a=tt("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,i,a),this.logger.error(a)}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(tt("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!wt(i)){const{message:n}=G("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Dg(i.uri)){const{message:n}=G("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!wt(i)){const{message:s}=G("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!wt(i)){const{message:s}=G("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!rt(i,!1)){const{message:n}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(er(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=G("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=ve.generateChildLogger(r,this.name),this.pairings=new Qi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ve.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Le.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);bs(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Xi(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.core.history.delete(r,n.id))})}registerExpirerEvents(){this.core.expirer.on(At.expired,async e=>{const{topic:r}=Ic(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class ew extends kf{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ce,this.name=C_,this.version=P_,this.cached=[],this.initialized=!1,this.storagePrefix=rr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const o={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:Rt(Q.THIRTY_DAYS)};this.records.set(o.id,o),this.events.emit(jt.created,o)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Nt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(jt.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(jt.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=ve.generateChildLogger(r,this.name)}get context(){return ve.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:Ji(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(jt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(jt.created,e=>{const r=jt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(jt.updated,e=>{const r=jt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(jt.deleted,e=>{const r=jt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{Q.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}class tw extends Qf{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ce,this.name=R_,this.version=N_,this.cached=[],this.initialized=!1,this.storagePrefix=rr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),o={target:s,expiry:n};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(At.created,{target:s,expiration:o})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(At.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=ve.generateChildLogger(r,this.name)}get context(){return ve.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return rg(e);if(typeof e=="number")return ig(e);const{message:r}=G("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(At.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Q.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(At.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(At.created,e=>{const r=At.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(At.expired,e=>{const r=At.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(At.deleted,e=>{const r=At.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}class rw extends ed{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=gn,this.initialized=!1,this.init=async i=>{vc()||!ds()||(this.verifyUrl=i?.verifyUrl||ta,await this.createIframe())},this.register=async i=>{var n;if(this.initialized||await this.init(),!!this.iframe)try{(n=this.iframe.contentWindow)==null||n.postMessage(i.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${i.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async i=>{var n;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${i.attestationId}`);const s=this.startAbortTimer(Q.FIVE_SECONDS),o=await fetch(`${this.verifyUrl}/attestation/${i.attestationId}`,{signal:this.abortController.signal});return clearTimeout(s),o.status===200?(n=await o.json())==null?void 0:n.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((i,n)=>{if(document.getElementById(gn))return i();const s=document.createElement("iframe");s.setAttribute("id",gn),s.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),s.style.display="none",s.addEventListener("load",()=>{this.initialized=!0,i()}),s.addEventListener("error",o=>{n(o)}),document.body.append(s),this.iframe=s}),new Promise(i=>{setTimeout(()=>i("iframe load timeout"),Q.toMiliseconds(Q.ONE_SECOND/2))})])}catch(i){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(i)}},this.logger=ve.generateChildLogger(r,this.name),this.verifyUrl=ta,this.abortController=new AbortController,this.isDevEnv=fs()&&process.env.IS_VITEST}get context(){return ve.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}var iw=Object.defineProperty,ua=Object.getOwnPropertySymbols,nw=Object.prototype.hasOwnProperty,sw=Object.prototype.propertyIsEnumerable,la=(t,e,r)=>e in t?iw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ha=(t,e)=>{for(var r in e||(e={}))nw.call(e,r)&&la(t,r,e[r]);if(ua)for(var r of ua(e))sw.call(e,r)&&la(t,r,e[r]);return t};class vs extends Wf{constructor(e){super(e),this.protocol=Wc,this.version=o_,this.name=ms,this.events=new ce,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Gc;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ve.pino(ve.getDefaultLoggerOptions({level:e?.logger||a_.logger}));this.logger=ve.generateChildLogger(r,this.name),this.heartbeat=new Nr.HeartBeat,this.crypto=new U_(this,this.logger,e?.keychain),this.history=new ew(this,this.logger),this.expirer=new tw(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new mh(ha(ha({},c_),e?.storageOptions)),this.relayer=new Y_({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Q_(this,this.logger),this.verify=new rw(this.projectId||"",this.logger)}static async init(e){const r=new vs(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(S_,i),r}get context(){return ve.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const ow=vs,Yc="wc",Jc=2,Xc="client",Es=`${Yc}@${Jc}:${Xc}:`,_n={name:Xc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},aw="WALLETCONNECT_DEEPLINK_CHOICE",cw="proposal",uw="Proposal expired",lw="session",Si=Q.SEVEN_DAYS,hw="engine",Xr={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1115}}},wn={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},fw="request",dw=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var pw=Object.defineProperty,gw=Object.defineProperties,yw=Object.getOwnPropertyDescriptors,fa=Object.getOwnPropertySymbols,_w=Object.prototype.hasOwnProperty,ww=Object.prototype.propertyIsEnumerable,da=(t,e,r)=>e in t?pw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ot=(t,e)=>{for(var r in e||(e={}))_w.call(e,r)&&da(t,r,e[r]);if(fa)for(var r of fa(e))ww.call(e,r)&&da(t,r,e[r]);return t},bn=(t,e)=>gw(t,yw(e));class bw extends rd{constructor(e){super(e),this.name=hw,this.events=new ce,this.initialized=!1,this.ignoredPayloadTypes=[Sr],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Xr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=bn(Ot({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,relays:h}=i;let l=n,f,y=!1;if(l&&(y=this.client.core.pairing.pairings.get(l).active),!l||!y){const{topic:O,uri:w}=await this.client.core.pairing.create();l=O,f=w}const _=await this.client.core.crypto.generateKeyPair(),b=Ot({requiredNamespaces:s,optionalNamespaces:o,relays:h??[{protocol:kc}],proposer:{publicKey:_,metadata:this.client.metadata}},a&&{sessionProperties:a}),{reject:E,resolve:C,done:F}=Tr(Q.FIVE_MINUTES,uw);if(this.events.once(Ke("session_connect"),async({error:O,session:w})=>{if(O)E(O);else if(w){w.self.publicKey=_;const v=bn(Ot({},w),{requiredNamespaces:w.requiredNamespaces,optionalNamespaces:w.optionalNamespaces});await this.client.session.set(w.topic,v),await this.setExpiry(w.topic,w.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:w.peer.metadata}),C(v)}}),!l){const{message:O}=G("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(O)}const z=await this.sendRequest(l,"wc_sessionPropose",b),D=Rt(Q.FIVE_MINUTES);return await this.setProposal(z,Ot({id:z,expiry:D},b)),{uri:f,approval:F}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:o}=r,a=this.client.proposal.get(i);let{pairingTopic:h,proposer:l,requiredNamespaces:f,optionalNamespaces:y}=a;h=h||"",Qr(f)||(f=wg(s,"approve()"));const _=await this.client.core.crypto.generateKeyPair(),b=l.publicKey,E=await this.client.core.crypto.generateSharedKey(_,b);h&&i&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:l.metadata}),await this.sendResult(i,h,{relay:{protocol:n??"irn"},responderPublicKey:_}),await this.client.proposal.delete(i,tt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const C=Ot({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:f,optionalNamespaces:y,pairingTopic:h,controller:{publicKey:_,metadata:this.client.metadata},expiry:Rt(Si)},o&&{sessionProperties:o});await this.client.core.relayer.subscribe(E),await this.sendRequest(E,"wc_sessionSettle",C);const F=bn(Ot({},C),{topic:E,pairingTopic:h,acknowledged:!1,self:C.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:_});return await this.client.session.set(E,F),await this.setExpiry(E,Rt(Si)),{topic:E,acknowledged:()=>new Promise(z=>setTimeout(()=>z(this.client.session.get(E)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,tt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:o,resolve:a,reject:h}=Tr();return this.events.once(Ke("session_update",s),({error:l})=>{l?h(l):a()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:o,reject:a}=Tr();return this.events.once(Ke("session_extend",n),({error:h})=>{h?a(h):o()}),await this.setExpiry(i,Rt(Si)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:o}=r,a=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i},o),{done:h,resolve:l,reject:f}=Tr(o);this.events.once(Ke("session_request",a),({error:_,result:b})=>{_?f(_):l(b)}),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:a});const y=await this.client.core.storage.getItem(aw);return ng({id:a,topic:s,wcDeepLink:y}),await h()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;kt(n)?await this.sendResult(s,i,n.result):Nt(n)&&await this.sendError(s,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:o,reject:a}=Tr();this.events.once(Ke("session_ping",n),({error:h})=>{h?a(h):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=ys().toString();let s;const o=a=>{a?.id.toString()===n&&(this.client.core.relayer.events.removeListener(Le.message_ack,o),s())};await Promise.all([new Promise(a=>{s=a,this.client.core.relayer.on(Le.message_ack,o)}),this.sendRequest(i,"wc_sessionDelete",tt("USER_DISCONNECTED"),void 0,n)]),await this.deleteSession(i)}else await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>vg(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,tt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(n.publicKey)&&await this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r)},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,tt("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Xr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:o}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:o}),i&&this.client.core.expirer.set(n,Rt(i))},this.sendRequest=async(r,i,n,s,o)=>{const a=Ji(i,n);if(ds()&&dw.includes(i)){const f=Pr(JSON.stringify(a));await this.client.core.verify.register({attestationId:f})}const h=await this.client.core.crypto.encode(r,a),l=Xr[i].req;return s&&(l.ttl=s),o&&(l.id=o),this.client.core.history.set(r,a),this.client.core.relayer.publish(r,h,l),a.id},this.sendResult=async(r,i,n)=>{const s=_s(r,n),o=await this.client.core.crypto.encode(i,s),a=await this.client.core.history.get(i,r),h=Xr[a.request.method].res;this.client.core.relayer.publish(i,o,h),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=ws(r,n),o=await this.client.core.crypto.encode(i,s),a=await this.client.core.history.get(i,r),h=Xr[a.request.method].res;this.client.core.relayer.publish(i,o,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{er(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{er(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:n}=G("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(Ot({},i.params));const o=Rt(Q.FIVE_MINUTES),a=Ot({id:s,pairingTopic:r,expiry:o},n);await this.setProposal(s,a);const h=Pr(JSON.stringify(i)),l=await this.getVerifyContext(h,a.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:a,verifyContext:l})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(kt(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const a=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const l=await this.client.core.crypto.generateSharedKey(a,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:l});const f=await this.client.core.relayer.subscribe(l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else Nt(i)&&(await this.client.proposal.delete(n,tt("USER_DISCONNECTED")),this.events.emit(Ke("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:h,namespaces:l,requiredNamespaces:f,optionalNamespaces:y,sessionProperties:_,pairingTopic:b}=i.params,E=Ot({topic:r,relay:o,expiry:h,namespaces:l,acknowledged:!0,pairingTopic:b,requiredNamespaces:f,optionalNamespaces:y,controller:a.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},_&&{sessionProperties:_});await this.sendResult(i.id,r,!0),this.events.emit(Ke("session_connect"),{session:E}),this.cleanupDuplicatePairings(E)}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;kt(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ke("session_approve",n),{})):Nt(i)&&(await this.client.session.delete(r,tt("USER_DISCONNECTED")),this.events.emit(Ke("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(Ot({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;kt(i)?this.events.emit(Ke("session_update",n),{}):Nt(i)&&this.events.emit(Ke("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Rt(Si)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;kt(i)?this.events.emit(Ke("session_extend",n),{}):Nt(i)&&this.events.emit(Ke("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{kt(i)?this.events.emit(Ke("session_ping",n),{}):Nt(i)&&this.events.emit(Ke("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(Le.publish,async()=>{s(await this.deleteSession(r))})}),this.sendResult(n,r,!0)]),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(Ot({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s});const o=Pr(JSON.stringify(i)),a=this.client.session.get(r),h=await this.getVerifyContext(o,a.peer.metadata);this.client.events.emit("session_request",{id:n,topic:r,params:s,verifyContext:h})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;kt(i)?this.events.emit(Ke("session_request",n),{result:i.result}):Nt(i)&&this.events.emit(Ke("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(Ot({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!wt(r)){const{message:h}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,relays:a}=r;if(gt(i)||await this.isValidPairingTopic(i),!Ng(a,!0)){const{message:h}=G("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(h)}!gt(n)&&Qr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!gt(s)&&Qr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),gt(o)||this.validateSessionProps(o,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=Rg(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!wt(r))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:o}=r;await this.isValidProposalId(i);const a=this.client.proposal.get(i),h=Ii(n,"approve()");if(h)throw new Error(h.message);const l=Bo(a.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!rt(s,!0)){const{message:f}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}gt(o)||this.validateSessionProps(o,"sessionProperties")},this.isValidReject=async r=>{if(!wt(r)){const{message:s}=G("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Ug(n)){const{message:s}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!wt(r)){const{message:l}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:i,controller:n,namespaces:s,expiry:o}=r;if(!Ac(i)){const{message:l}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=Ig(n,"onSessionSettleRequest()");if(a)throw new Error(a.message);const h=Ii(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(er(o)){const{message:l}=G("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async r=>{if(!wt(r)){const{message:h}=G("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),o=Ii(n,"update()");if(o)throw new Error(o.message);const a=Bo(s.requiredNamespaces,n,"update()");if(a)throw new Error(a.message)},this.isValidExtend=async r=>{if(!wt(r)){const{message:n}=G("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!wt(r)){const{message:h}=G("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:n,chainId:s,expiry:o}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!jo(a,s)){const{message:h}=G("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!Lg(n)){const{message:h}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(h)}if(!jg(a,s,n.method)){const{message:h}=G("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(h)}if(o&&!Kg(o,wn)){const{message:h}=G("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${wn.min} and ${wn.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!wt(r)){const{message:s}=G("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!$g(n)){const{message:s}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!wt(r)){const{message:n}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!wt(r)){const{message:a}=G("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!jo(o,s)){const{message:a}=G("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!Mg(n)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}if(!Bg(o,s,n.name)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}},this.isValidDisconnect=async r=>{if(!wt(r)){const{message:n}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const n={verified:{verifyUrl:i.verifyUrl||"",validation:"UNKNOWN",origin:i.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});s&&(n.verified.origin=s,n.verified.validation=s===i.url?"VALID":"INVALID")}catch(s){this.client.logger.error(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!rt(n,!1)){const{message:s}=G("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Le.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);bs(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Xi(n)?(await this.client.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.client.core.history.delete(r,n.id)):this.onRelayEventUnknownPayload({topic:r,payload:n})})}registerExpirerEvents(){this.client.core.expirer.on(At.expired,async e=>{const{topic:r,id:i}=Ic(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,G("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!rt(e,!1)){const{message:r}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(er(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=G("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!rt(e,!1)){const{message:r}=G("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(er(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=G("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(rt(e,!1)){const{message:r}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Fg(e)){const{message:r}=G("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(er(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=G("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class mw extends Qi{constructor(e,r){super(e,r,cw,Es),this.core=e,this.logger=r}}class vw extends Qi{constructor(e,r){super(e,r,lw,Es),this.core=e,this.logger=r}}class Ew extends Qi{constructor(e,r){super(e,r,fw,Es,i=>i.id),this.core=e,this.logger=r}}class Ds extends td{constructor(e){super(e),this.protocol=Yc,this.version=Jc,this.name=_n.name,this.events=new ce,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||_n.name,this.metadata=e?.metadata||X0();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:ve.pino(ve.getDefaultLoggerOptions({level:e?.logger||_n.logger}));this.core=e?.core||new ow(e),this.logger=ve.generateChildLogger(r,this.name),this.session=new vw(this.core,this.logger),this.proposal=new mw(this.core,this.logger),this.pendingRequest=new Ew(this.core,this.logger),this.engine=new bw(this)}static async init(e){const r=new Ds(e);return await r.initialize(),r}get context(){return ve.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var Dw=Object.defineProperty,Sw=Object.defineProperties,xw=Object.getOwnPropertyDescriptors,pa=Object.getOwnPropertySymbols,Iw=Object.prototype.hasOwnProperty,Ow=Object.prototype.propertyIsEnumerable,ga=(t,e,r)=>e in t?Dw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Aw=(t,e)=>{for(var r in e||(e={}))Iw.call(e,r)&&ga(t,r,e[r]);if(pa)for(var r of pa(e))Ow.call(e,r)&&ga(t,r,e[r]);return t},Tw=(t,e)=>Sw(t,xw(e)),Ss=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},Ce=(t,e,r)=>(Ss(t,e,"read from private field"),r?r.call(t):e.get(t)),yr=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Li=(t,e,r,i)=>(Ss(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),lt=(t,e,r)=>(Ss(t,e,"access private method"),r),_r,Cr,Zr,et,Xn,Zc,ht,dt,Zn,ya;class zw{constructor(e){yr(this,Xn),yr(this,ht),yr(this,Zn),yr(this,_r,void 0),yr(this,Cr,void 0),yr(this,Zr,void 0),yr(this,et,void 0),Li(this,_r,e),Li(this,Cr,lt(this,Xn,Zc).call(this)),lt(this,ht,dt).call(this)}async connect(e){const{requiredNamespaces:r,optionalNamespaces:i}=e;return new Promise(async(n,s)=>{await lt(this,ht,dt).call(this);const o=Ce(this,Cr).subscribeModal(l=>{l.open||(o(),s(new Error("Modal closed")))}),{uri:a,approval:h}=await Ce(this,et).connect(e);if(a){const l=new Set;r&&Object.values(r).forEach(({chains:f})=>{f&&f.forEach(y=>l.add(y))}),i&&Object.values(i).forEach(({chains:f})=>{f&&f.forEach(y=>l.add(y))}),await Ce(this,Cr).openModal({uri:a,chains:Array.from(l)})}try{const l=await h();n(l)}catch(l){s(l)}finally{o(),Ce(this,Cr).closeModal()}})}async disconnect(e){await lt(this,ht,dt).call(this),await Ce(this,et).disconnect(e)}async request(e){return await lt(this,ht,dt).call(this),await Ce(this,et).request(e)}async getSessions(){return await lt(this,ht,dt).call(this),Ce(this,et).session.getAll()}async getSession(){return await lt(this,ht,dt).call(this),Ce(this,et).session.getAll().at(-1)}async onSessionEvent(e){await lt(this,ht,dt).call(this),Ce(this,et).on("session_event",e)}async offSessionEvent(e){await lt(this,ht,dt).call(this),Ce(this,et).off("session_event",e)}async onSessionUpdate(e){await lt(this,ht,dt).call(this),Ce(this,et).on("session_update",e)}async offSessionUpdate(e){await lt(this,ht,dt).call(this),Ce(this,et).off("session_update",e)}async onSessionDelete(e){await lt(this,ht,dt).call(this),Ce(this,et).on("session_delete",e)}async offSessionDelete(e){await lt(this,ht,dt).call(this),Ce(this,et).off("session_delete",e)}async onSessionExpire(e){await lt(this,ht,dt).call(this),Ce(this,et).on("session_expire",e)}async offSessionExpire(e){await lt(this,ht,dt).call(this),Ce(this,et).off("session_expire",e)}}_r=new WeakMap,Cr=new WeakMap,Zr=new WeakMap,et=new WeakMap,Xn=new WeakSet,Zc=function(){const{modalOptions:t,projectId:e}=Ce(this,_r);return new Fl(Tw(Aw({},t),{projectId:e}))},ht=new WeakSet,dt=async function(){return Ce(this,et)?!0:(!Ce(this,Zr)&&typeof window<"u"&&Li(this,Zr,lt(this,Zn,ya).call(this)),Ce(this,Zr))},Zn=new WeakSet,ya=async function(){Li(this,et,await Ds.init({metadata:Ce(this,_r).metadata,projectId:Ce(this,_r).projectId,relayUrl:Ce(this,_r).relayUrl}));const t=await Ce(this,et).core.crypto.getClientId();try{localStorage.setItem("WCM_WALLETCONNECT_CLIENT_ID",t)}catch{console.info("Unable to set client id")}};export{Pa as E,Cw as H,Sl as S,rn as V,zw as W,Ws as X,Pw as Y,pt as i,Ft as l,Rr as v};
//# sourceMappingURL=bundle-97b3c7b0.js.map
