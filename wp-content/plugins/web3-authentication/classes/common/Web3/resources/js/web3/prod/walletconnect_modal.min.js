import{WalletConnectModalSign as e}from"../walletconnect/dist/cdn/bundle.js";let web3Modal=new e({projectId:"8cbc51134cb272bb74d29cd8132a85d4"});async function onConnect(){return new Promise(async(e,n)=>{let t=null;try{connectButton.disabled=!0,t=await web3Modal.connect({requiredNamespaces:{eip155:{methods:["personal_sign"],chains:["eip155:1"],events:["chainChanged","accountsChanged"]}}})}catch(a){n(a)}finally{connectButton.disabled=!1,e(t)}})}async function signMessage(e,n){return new Promise(async(t,a)=>{try{await jQuery.post(ajaxurl,{action:"type_of_request",request:"login",address:n,mo_web3_verify_nonce:wp_nonce},async function(a){if("Error"!==a.substring(0,5)){let c=await web3Modal.request({topic:e.topic,chainId:"eip155:1",request:{method:"personal_sign",params:[a,n,]}});t(c)}})}catch(c){a(c)}})}function handleAuthenticate(e,n){var t={action:"type_of_request",address:e,request:"auth",signature:n,mo_web3_verify_nonce:wp_nonce};jQuery.post(ajaxurl,t,async function(t){if(t.isSignatureVerified){if(t.isTesting)openModal(e);else{let a=e;is_testing_wallet_address&&(a=is_testing_wallet_address);post_to_url("",{address:e,nonce:t.nonce,signature:n,walletsBlockchain:"evm"},"post","mo_web3_hiddenform_nonce")}}})}async function moweb3WalletConnect(){try{jQuery("#multipleCryptowalletModal").modal("hide");let e=await onConnect(),n=e.namespaces.eip155.accounts[0].split(":")[2],t=await signMessage(e,n);handleAuthenticate(n,t)}catch(a){}}let connectButton=document.getElementById("moweb3WalletConnect");connectButton.addEventListener("click",moweb3WalletConnect);